<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/AgenticGoKitDocs/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=AgenticGoKitDocs/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.148.1">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="description" content="Tool Integration in AgenticGoKit Overview Integrating tools with agents is a key capability in AgenticGoKit that enables agents to perform actions beyond text generation. This tutorial covers how to connect tools to agents, configure tool access, handle tool results, and implement tool-aware prompting.
Effective tool integration allows agents to interact with external systems, access specialized information, and perform complex tasks while maintaining a natural conversation flow.
Prerequisites Understanding of MCP Overview Familiarity with Tool Development Knowledge of Agent Lifecycle Basic understanding of State Management MCP Integration Architecture ┌─────────────┐ ┌───────────────┐ ┌─────────────┐│ │ │ │ │ ││ Agent │────▶│ MCP Manager │────▶│ Tool ││ │ │ │ │ │└─────────────┘ └───────────────┘ └─────────────┘▲ │ ││ ▼ ▼│ ┌───────────────┐ ┌─────────────┐└──────────────│ Tool Result │◀───│ External ││ Processor │ │ Service │└───────────────┘ └─────────────┘Basic Tool Integration 1. Setting Up MCP Manager package main import ( &#34;context&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) mcpManager.RegisterTool(&#34;counter&#34;, tools.NewCounterTool()) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent with MCP capability agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;, &#34;counter&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Create event with user query event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;What&#39;s 25 * 16 and what&#39;s the weather in New York?&#34;}, map[string]string{&#34;session_id&#34;: &#34;test-session&#34;}, ) // Register callback to handle agent response runner.RegisterCallback(core.HookAfterAgentRun, &#34;response-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { if response, ok := args.AgentResult.OutputState.Get(&#34;response&#34;); ok { fmt.Printf(&#34;Agent response: %s\n&#34;, response) } return args.State, nil }, ) // Emit event runner.Emit(event) // Wait for response time.Sleep(5 * time.Second) }2. Tool-Aware Prompting func createToolAwareAgent() (core.AgentHandler, error) { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { return nil, fmt.Errorf(&#34;failed to create LLM provider: %w&#34;, err) } // Create tool-aware system prompt systemPrompt := `You are a helpful assistant with access to the following tools: 1. calculator: Performs basic arithmetic operations (add, subtract, multiply, divide) - Parameters: operation (string), a (number), b (number) 2. weather: Gets current weather information for a specified location - Parameters: location (string), units (string, optional) When you need to use a tool, use the following format: &lt;tool&gt;calculator&lt;/tool&gt; &lt;parameters&gt; { &#34;operation&#34;: &#34;add&#34;, &#34;a&#34;: 5, &#34;b&#34;: 3 } &lt;/parameters&gt; Wait for the tool result before continuing. Tool results will be provided in this format: &lt;tool_result&gt; { &#34;result&#34;: 8 } &lt;/tool_result&gt; Answer user questions directly when you can, and use tools when necessary.` // Create agent with MCP capability and tool-aware prompt return core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithSystemPrompt(systemPrompt). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() }3. Handling Tool Results func setupToolResultHandling(runner *core.Runner) { // Register callback for tool execution runner.RegisterCallback(core.HookBeforeToolExecution, &#34;tool-execution-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolParams := args.ToolParams fmt.Printf(&#34;Executing tool: %s with params: %v\n&#34;, toolName, toolParams) return args.State, nil }, ) // Register callback for tool result runner.RegisterCallback(core.HookAfterToolExecution, &#34;tool-result-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolResult := args.ToolResult toolError := args.Error if toolError != nil { fmt.Printf(&#34;Tool %s failed: %v\n&#34;, toolName, toolError) } else { fmt.Printf(&#34;Tool %s result: %v\n&#34;, toolName, toolResult) } return args.State, nil }, ) // Register callback for tool error runner.RegisterCallback(core.HookToolError, &#34;tool-error-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolError := args.Error fmt.Printf(&#34;Tool error: %s - %v\n&#34;, toolName, toolError) // Add error information to state newState := args.State.Clone() newState.Set(&#34;tool_error&#34;, fmt.Sprintf(&#34;The %s tool encountered an error: %v&#34;, toolName, toolError)) return newState, nil }, ) }Advanced Tool Integration 1. Dynamic Tool Selection type DynamicToolSelector struct { tools map[string]core.Tool llmProvider core.LLMProvider } func NewDynamicToolSelector(llmProvider core.LLMProvider) *DynamicToolSelector { return &amp;DynamicToolSelector{ tools: make(map[string]core.Tool), llmProvider: llmProvider, } } func (dts *DynamicToolSelector) RegisterTool(name string, tool core.Tool) { dts.tools[name] = tool } func (dts *DynamicToolSelector) SelectTools(ctx context.Context, query string) ([]string, error) { // Create tool descriptions var toolDescriptions strings.Builder for name, tool := range dts.tools { toolDescriptions.WriteString(fmt.Sprintf(&#34;- %s: %s\n&#34;, name, tool.Description())) } // Create prompt for tool selection prompt := fmt.Sprintf(`Given the following user query and available tools, select the most appropriate tools to answer the query. User query: %s Available tools: %s Return only the names of the tools that should be used, separated by commas (e.g., &#34;calculator,weather&#34;). If no tools are needed, return &#34;none&#34;. Selected tools:`, query, toolDescriptions.String()) // Get tool selection from LLM response, err := dts.llmProvider.Generate(ctx, prompt) if err != nil { return nil, fmt.Errorf(&#34;tool selection failed: %w&#34;, err) } // Parse response response = strings.TrimSpace(response) if response == &#34;none&#34; { return []string{}, nil } // Split by comma and trim spaces selectedTools := strings.Split(response, &#34;,&#34;) for i := range selectedTools { selectedTools[i] = strings.TrimSpace(selectedTools[i]) } // Validate selected tools validTools := make([]string, 0, len(selectedTools)) for _, name := range selectedTools { if _, exists := dts.tools[name]; exists { validTools = append(validTools, name) } } return validTools, nil }2. Tool Result Processing type ToolResultProcessor struct { llmProvider core.LLMProvider } func NewToolResultProcessor(llmProvider core.LLMProvider) *ToolResultProcessor { return &amp;ToolResultProcessor{ llmProvider: llmProvider, } } func (trp *ToolResultProcessor) ProcessResult(ctx context.Context, toolName string, result interface{}, query string) (string, error) { // Convert result to string representation resultStr := fmt.Sprintf(&#34;%v&#34;, result) if resultMap, ok := result.(map[string]interface{}); ok { resultBytes, err := json.MarshalIndent(resultMap, &#34;&#34;, &#34; &#34;) if err == nil { resultStr = string(resultBytes) } } // Create prompt for result processing prompt := fmt.Sprintf(`You are processing the result of a tool execution. Format the result in a clear, human-readable way that answers the user&#39;s query. User query: %s Tool used: %s Tool result: %s Provide a concise, helpful response based on this result:`, query, toolName, resultStr) // Get formatted response from LLM return trp.llmProvider.Generate(ctx, prompt) }3. Tool Caching and Performance type CachedTool struct { tool core.Tool cache map[string]CacheEntry cacheTTL time.Duration mu sync.RWMutex } type CacheEntry struct { Result interface{} Timestamp time.Time } func NewCachedTool(tool core.Tool, cacheTTL time.Duration) *CachedTool { return &amp;CachedTool{ tool: tool, cache: make(map[string]CacheEntry), cacheTTL: cacheTTL, } } func (ct *CachedTool) Name() string { return ct.tool.Name() } func (ct *CachedTool) Description() string { return ct.tool.Description() } func (ct *CachedTool) ParameterSchema() map[string]core.ParameterDefinition { return ct.tool.ParameterSchema() } func (ct *CachedTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { // Create cache key from parameters cacheKey := ct.createCacheKey(params) // Check cache if result, found := ct.getCachedResult(cacheKey); found { return result, nil } // Execute tool result, err := ct.tool.Execute(ctx, params) if err != nil { return nil, err } // Cache result ct.setCachedResult(cacheKey, result) return result, nil } func (ct *CachedTool) createCacheKey(params map[string]interface{}) string { // Create deterministic key from parameters keys := make([]string, 0, len(params)) for k := range params { keys = append(keys, k) } sort.Strings(keys) var keyBuilder strings.Builder for _, k := range keys { keyBuilder.WriteString(fmt.Sprintf(&#34;%s:%v;&#34;, k, params[k])) } // Hash the key for consistent length hasher := sha256.New() hasher.Write([]byte(keyBuilder.String())) return fmt.Sprintf(&#34;%x&#34;, hasher.Sum(nil)) } func (ct *CachedTool) getCachedResult(key string) (interface{}, bool) { ct.mu.RLock() defer ct.mu.RUnlock() entry, exists := ct.cache[key] if !exists { return nil, false } // Check if entry is expired if time.Since(entry.Timestamp) &gt; ct.cacheTTL { return nil, false } return entry.Result, true } func (ct *CachedTool) setCachedResult(key string, result interface{}) { ct.mu.Lock() defer ct.mu.Unlock() ct.cache[key] = CacheEntry{ Result: result, Timestamp: time.Now(), } // Clean up expired entries periodically if len(ct.cache)%100 == 0 { go ct.cleanupExpiredEntries() } } func (ct *CachedTool) cleanupExpiredEntries() { ct.mu.Lock() defer ct.mu.Unlock() now := time.Now() for key, entry := range ct.cache { if now.Sub(entry.Timestamp) &gt; ct.cacheTTL { delete(ct.cache, key) } } }Tool Configuration and Management 1. Tool Configuration type ToolConfig struct { Name string `json:&#34;name&#34;` Enabled bool `json:&#34;enabled&#34;` MaxCalls int `json:&#34;max_calls&#34;` Timeout time.Duration `json:&#34;timeout&#34;` RateLimit RateLimitConfig `json:&#34;rate_limit&#34;` Cache CacheConfig `json:&#34;cache&#34;` Parameters map[string]interface{} `json:&#34;parameters&#34;` } type RateLimitConfig struct { MaxRequests int `json:&#34;max_requests&#34;` Interval time.Duration `json:&#34;interval&#34;` } type CacheConfig struct { Enabled bool `json:&#34;enabled&#34;` TTL time.Duration `json:&#34;ttl&#34;` } type ToolManager struct { tools map[string]core.Tool configs map[string]ToolConfig mu sync.RWMutex } func NewToolManager() *ToolManager { return &amp;ToolManager{ tools: make(map[string]core.Tool), configs: make(map[string]ToolConfig), } } func (tm *ToolManager) RegisterTool(tool core.Tool, config ToolConfig) error { tm.mu.Lock() defer tm.mu.Unlock() name := tool.Name() // Apply configuration wrappers wrappedTool := tool // Add caching if enabled if config.Cache.Enabled { wrappedTool = NewCachedTool(wrappedTool, config.Cache.TTL) } // Add rate limiting if configured if config.RateLimit.MaxRequests &gt; 0 { wrappedTool = NewRateLimitedTool(wrappedTool, config.RateLimit.MaxRequests, config.RateLimit.Interval) } // Add validation wrappedTool = NewValidatedTool(wrappedTool, true) tm.tools[name] = wrappedTool tm.configs[name] = config return nil } func (tm *ToolManager) GetTool(name string) (core.Tool, error) { tm.mu.RLock() defer tm.mu.RUnlock() tool, exists := tm.tools[name] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, name) } config := tm.configs[name] if !config.Enabled { return nil, fmt.Errorf(&#34;tool disabled: %s&#34;, name) } return tool, nil } func (tm *ToolManager) ListEnabledTools() []string { tm.mu.RLock() defer tm.mu.RUnlock() var enabled []string for name, config := range tm.configs { if config.Enabled { enabled = append(enabled, name) } } return enabled }2. Tool Discovery and Registration type ToolDiscovery struct { registry map[string]ToolFactory mu sync.RWMutex } type ToolFactory func(config map[string]interface{}) (core.Tool, error) func NewToolDiscovery() *ToolDiscovery { td := &amp;ToolDiscovery{ registry: make(map[string]ToolFactory), } // Register built-in tool factories td.RegisterFactory(&#34;calculator&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCalculatorTool(), nil }) td.RegisterFactory(&#34;weather&#34;, func(config map[string]interface{}) (core.Tool, error) { apiKey, ok := config[&#34;api_key&#34;].(string) if !ok || apiKey == &#34;&#34; { return nil, fmt.Errorf(&#34;weather tool requires api_key parameter&#34;) } return tools.NewWeatherTool(apiKey), nil }) td.RegisterFactory(&#34;counter&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCounterTool(), nil }) return td } func (td *ToolDiscovery) RegisterFactory(name string, factory ToolFactory) { td.mu.Lock() defer td.mu.Unlock() td.registry[name] = factory } func (td *ToolDiscovery) CreateTool(name string, config map[string]interface{}) (core.Tool, error) { td.mu.RLock() factory, exists := td.registry[name] td.mu.RUnlock() if !exists { return nil, fmt.Errorf(&#34;unknown tool type: %s&#34;, name) } return factory(config) } func (td *ToolDiscovery) ListAvailableTools() []string { td.mu.RLock() defer td.mu.RUnlock() tools := make([]string, 0, len(td.registry)) for name := range td.registry { tools = append(tools, name) } return tools }Production Integration Patterns 1. Tool Health Monitoring type ToolHealthMonitor struct { tools map[string]core.Tool metrics map[string]*ToolMetrics mu sync.RWMutex } type ToolMetrics struct { TotalCalls int64 `json:&#34;total_calls&#34;` SuccessCalls int64 `json:&#34;success_calls&#34;` ErrorCalls int64 `json:&#34;error_calls&#34;` AverageTime time.Duration `json:&#34;average_time&#34;` LastError string `json:&#34;last_error&#34;` LastErrorTime time.Time `json:&#34;last_error_time&#34;` } func NewToolHealthMonitor() *ToolHealthMonitor { return &amp;ToolHealthMonitor{ tools: make(map[string]core.Tool), metrics: make(map[string]*ToolMetrics), } } func (thm *ToolHealthMonitor) WrapTool(tool core.Tool) core.Tool { thm.mu.Lock() defer thm.mu.Unlock() name := tool.Name() thm.tools[name] = tool thm.metrics[name] = &amp;ToolMetrics{} return &amp;MonitoredTool{ tool: tool, monitor: thm, } } type MonitoredTool struct { tool core.Tool monitor *ToolHealthMonitor } func (mt *MonitoredTool) Name() string { return mt.tool.Name() } func (mt *MonitoredTool) Description() string { return mt.tool.Description() } func (mt *MonitoredTool) ParameterSchema() map[string]core.ParameterDefinition { return mt.tool.ParameterSchema() } func (mt *MonitoredTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { start := time.Now() name := mt.tool.Name() // Execute tool result, err := mt.tool.Execute(ctx, params) // Record metrics duration := time.Since(start) mt.monitor.recordExecution(name, duration, err) return result, err } func (thm *ToolHealthMonitor) recordExecution(toolName string, duration time.Duration, err error) { thm.mu.Lock() defer thm.mu.Unlock() metrics := thm.metrics[toolName] metrics.TotalCalls&#43;&#43; if err != nil { metrics.ErrorCalls&#43;&#43; metrics.LastError = err.Error() metrics.LastErrorTime = time.Now() } else { metrics.SuccessCalls&#43;&#43; } // Update average time (simple moving average) if metrics.TotalCalls == 1 { metrics.AverageTime = duration } else { metrics.AverageTime = time.Duration( (int64(metrics.AverageTime)*metrics.TotalCalls &#43; int64(duration)) / (metrics.TotalCalls &#43; 1), ) } } func (thm *ToolHealthMonitor) GetMetrics(toolName string) (*ToolMetrics, error) { thm.mu.RLock() defer thm.mu.RUnlock() metrics, exists := thm.metrics[toolName] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, toolName) } // Return a copy to avoid race conditions return &amp;ToolMetrics{ TotalCalls: metrics.TotalCalls, SuccessCalls: metrics.SuccessCalls, ErrorCalls: metrics.ErrorCalls, AverageTime: metrics.AverageTime, LastError: metrics.LastError, LastErrorTime: metrics.LastErrorTime, }, nil } func (thm *ToolHealthMonitor) GetHealthStatus() map[string]string { thm.mu.RLock() defer thm.mu.RUnlock() status := make(map[string]string) for name, metrics := range thm.metrics { if metrics.TotalCalls == 0 { status[name] = &#34;unknown&#34; continue } errorRate := float64(metrics.ErrorCalls) / float64(metrics.TotalCalls) switch { case errorRate == 0: status[name] = &#34;healthy&#34; case errorRate &lt; 0.1: status[name] = &#34;warning&#34; default: status[name] = &#34;unhealthy&#34; } } return status }2. Complete Integration Example package main import ( &#34;context&#34; &#34;encoding/json&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create tool discovery and manager discovery := NewToolDiscovery() manager := NewToolManager() monitor := NewToolHealthMonitor() // Configure tools toolConfigs := []struct { name string config ToolConfig params map[string]interface{} }{ { name: &#34;calculator&#34;, config: ToolConfig{ Name: &#34;calculator&#34;, Enabled: true, MaxCalls: 100, Timeout: 5 * time.Second, Cache: CacheConfig{ Enabled: true, TTL: 1 * time.Hour, }, }, }, { name: &#34;weather&#34;, config: ToolConfig{ Name: &#34;weather&#34;, Enabled: true, MaxCalls: 50, Timeout: 10 * time.Second, RateLimit: RateLimitConfig{ MaxRequests: 10, Interval: 1 * time.Minute, }, Cache: CacheConfig{ Enabled: true, TTL: 15 * time.Minute, }, }, params: map[string]interface{}{ &#34;api_key&#34;: os.Getenv(&#34;WEATHER_API_KEY&#34;), }, }, } // Create and register tools for _, tc := range toolConfigs { tool, err := discovery.CreateTool(tc.name, tc.params) if err != nil { log.Fatalf(&#34;Failed to create tool %s: %v&#34;, tc.name, err) } // Wrap with monitoring monitoredTool := monitor.WrapTool(tool) // Register with manager if err := manager.RegisterTool(monitoredTool, tc.config); err != nil { log.Fatalf(&#34;Failed to register tool %s: %v&#34;, tc.name, err) } } // Create MCP manager and register tools mcpManager := core.NewMCPManager() for _, toolName := range manager.ListEnabledTools() { tool, err := manager.GetTool(toolName) if err != nil { log.Printf(&#34;Failed to get tool %s: %v&#34;, toolName, err) continue } mcpManager.RegisterTool(toolName, tool) } // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: manager.ListEnabledTools(), MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner with tool monitoring runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Setup tool result handling setupToolResultHandling(runner) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Example interaction event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;Calculate 15 * 23 and tell me the weather in London&#34;}, map[string]string{&#34;session_id&#34;: &#34;demo-session&#34;}, ) runner.Emit(event) // Wait and show metrics time.Sleep(10 * time.Second) // Display tool health metrics fmt.Println(&#34;\nTool Health Status:&#34;) healthStatus := monitor.GetHealthStatus() for tool, status := range healthStatus { fmt.Printf(&#34;- %s: %s\n&#34;, tool, status) if metrics, err := monitor.GetMetrics(tool); err == nil { fmt.Printf(&#34; Calls: %d (Success: %d, Errors: %d)\n&#34;, metrics.TotalCalls, metrics.SuccessCalls, metrics.ErrorCalls) fmt.Printf(&#34; Average Time: %v\n&#34;, metrics.AverageTime) if metrics.LastError != &#34;&#34; { fmt.Printf(&#34; Last Error: %s (%v)\n&#34;, metrics.LastError, metrics.LastErrorTime) } } } }Best Practices 1. Tool Integration Guidelines Selective Tool Access: Only provide agents with tools they actually need Tool Validation: Always validate tool parameters and results Error Handling: Implement robust error handling and recovery Performance Monitoring: Monitor tool performance and health Security: Implement proper authentication and authorization Caching: Use caching for expensive or frequently called tools Rate Limiting: Protect external services with rate limiting 2. Prompting Best Practices Clear Tool Descriptions: Provide clear, concise tool descriptions Parameter Documentation: Document all parameters with examples Usage Examples: Include examples of when and how to use tools Error Guidance: Explain how to handle tool errors Tool Selection: Guide the agent on tool selection criteria 3. Production Considerations Monitoring: Implement comprehensive tool monitoring Logging: Log all tool executions for debugging Metrics: Track tool usage and performance metrics Health Checks: Implement tool health checking Fallbacks: Provide fallback mechanisms for tool failures Configuration: Make tool configuration externally manageable Troubleshooting Common Issues Tool Not Found: Ensure tools are properly registered with the MCP manager Parameter Validation Errors: Check parameter schemas and validation rules Timeout Errors: Adjust tool timeout settings for slow operations Rate Limit Exceeded: Configure appropriate rate limits for external services Authentication Failures: Verify API keys and authentication credentials Debugging Tips Enable detailed logging for tool executions Use tool health monitoring to identify problematic tools Test tools independently before integrating with agents Monitor tool performance metrics regularly Implement proper error handling and recovery mechanisms Conclusion Tool integration is a powerful feature that extends agent capabilities beyond text generation. By following the patterns and best practices in this tutorial, you can create robust, scalable tool integrations that enhance your agent systems.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="tool-integration :: AgenticGoKit Docs">
    <meta name="twitter:description" content="Tool Integration in AgenticGoKit Overview Integrating tools with agents is a key capability in AgenticGoKit that enables agents to perform actions beyond text generation. This tutorial covers how to connect tools to agents, configure tool access, handle tool results, and implement tool-aware prompting.
Effective tool integration allows agents to interact with external systems, access specialized information, and perform complex tasks while maintaining a natural conversation flow.
Prerequisites Understanding of MCP Overview Familiarity with Tool Development Knowledge of Agent Lifecycle Basic understanding of State Management MCP Integration Architecture ┌─────────────┐ ┌───────────────┐ ┌─────────────┐│ │ │ │ │ ││ Agent │────▶│ MCP Manager │────▶│ Tool ││ │ │ │ │ │└─────────────┘ └───────────────┘ └─────────────┘▲ │ ││ ▼ ▼│ ┌───────────────┐ ┌─────────────┐└──────────────│ Tool Result │◀───│ External ││ Processor │ │ Service │└───────────────┘ └─────────────┘Basic Tool Integration 1. Setting Up MCP Manager package main import ( &#34;context&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) mcpManager.RegisterTool(&#34;counter&#34;, tools.NewCounterTool()) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent with MCP capability agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;, &#34;counter&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Create event with user query event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;What&#39;s 25 * 16 and what&#39;s the weather in New York?&#34;}, map[string]string{&#34;session_id&#34;: &#34;test-session&#34;}, ) // Register callback to handle agent response runner.RegisterCallback(core.HookAfterAgentRun, &#34;response-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { if response, ok := args.AgentResult.OutputState.Get(&#34;response&#34;); ok { fmt.Printf(&#34;Agent response: %s\n&#34;, response) } return args.State, nil }, ) // Emit event runner.Emit(event) // Wait for response time.Sleep(5 * time.Second) }2. Tool-Aware Prompting func createToolAwareAgent() (core.AgentHandler, error) { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { return nil, fmt.Errorf(&#34;failed to create LLM provider: %w&#34;, err) } // Create tool-aware system prompt systemPrompt := `You are a helpful assistant with access to the following tools: 1. calculator: Performs basic arithmetic operations (add, subtract, multiply, divide) - Parameters: operation (string), a (number), b (number) 2. weather: Gets current weather information for a specified location - Parameters: location (string), units (string, optional) When you need to use a tool, use the following format: &lt;tool&gt;calculator&lt;/tool&gt; &lt;parameters&gt; { &#34;operation&#34;: &#34;add&#34;, &#34;a&#34;: 5, &#34;b&#34;: 3 } &lt;/parameters&gt; Wait for the tool result before continuing. Tool results will be provided in this format: &lt;tool_result&gt; { &#34;result&#34;: 8 } &lt;/tool_result&gt; Answer user questions directly when you can, and use tools when necessary.` // Create agent with MCP capability and tool-aware prompt return core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithSystemPrompt(systemPrompt). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() }3. Handling Tool Results func setupToolResultHandling(runner *core.Runner) { // Register callback for tool execution runner.RegisterCallback(core.HookBeforeToolExecution, &#34;tool-execution-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolParams := args.ToolParams fmt.Printf(&#34;Executing tool: %s with params: %v\n&#34;, toolName, toolParams) return args.State, nil }, ) // Register callback for tool result runner.RegisterCallback(core.HookAfterToolExecution, &#34;tool-result-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolResult := args.ToolResult toolError := args.Error if toolError != nil { fmt.Printf(&#34;Tool %s failed: %v\n&#34;, toolName, toolError) } else { fmt.Printf(&#34;Tool %s result: %v\n&#34;, toolName, toolResult) } return args.State, nil }, ) // Register callback for tool error runner.RegisterCallback(core.HookToolError, &#34;tool-error-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolError := args.Error fmt.Printf(&#34;Tool error: %s - %v\n&#34;, toolName, toolError) // Add error information to state newState := args.State.Clone() newState.Set(&#34;tool_error&#34;, fmt.Sprintf(&#34;The %s tool encountered an error: %v&#34;, toolName, toolError)) return newState, nil }, ) }Advanced Tool Integration 1. Dynamic Tool Selection type DynamicToolSelector struct { tools map[string]core.Tool llmProvider core.LLMProvider } func NewDynamicToolSelector(llmProvider core.LLMProvider) *DynamicToolSelector { return &amp;DynamicToolSelector{ tools: make(map[string]core.Tool), llmProvider: llmProvider, } } func (dts *DynamicToolSelector) RegisterTool(name string, tool core.Tool) { dts.tools[name] = tool } func (dts *DynamicToolSelector) SelectTools(ctx context.Context, query string) ([]string, error) { // Create tool descriptions var toolDescriptions strings.Builder for name, tool := range dts.tools { toolDescriptions.WriteString(fmt.Sprintf(&#34;- %s: %s\n&#34;, name, tool.Description())) } // Create prompt for tool selection prompt := fmt.Sprintf(`Given the following user query and available tools, select the most appropriate tools to answer the query. User query: %s Available tools: %s Return only the names of the tools that should be used, separated by commas (e.g., &#34;calculator,weather&#34;). If no tools are needed, return &#34;none&#34;. Selected tools:`, query, toolDescriptions.String()) // Get tool selection from LLM response, err := dts.llmProvider.Generate(ctx, prompt) if err != nil { return nil, fmt.Errorf(&#34;tool selection failed: %w&#34;, err) } // Parse response response = strings.TrimSpace(response) if response == &#34;none&#34; { return []string{}, nil } // Split by comma and trim spaces selectedTools := strings.Split(response, &#34;,&#34;) for i := range selectedTools { selectedTools[i] = strings.TrimSpace(selectedTools[i]) } // Validate selected tools validTools := make([]string, 0, len(selectedTools)) for _, name := range selectedTools { if _, exists := dts.tools[name]; exists { validTools = append(validTools, name) } } return validTools, nil }2. Tool Result Processing type ToolResultProcessor struct { llmProvider core.LLMProvider } func NewToolResultProcessor(llmProvider core.LLMProvider) *ToolResultProcessor { return &amp;ToolResultProcessor{ llmProvider: llmProvider, } } func (trp *ToolResultProcessor) ProcessResult(ctx context.Context, toolName string, result interface{}, query string) (string, error) { // Convert result to string representation resultStr := fmt.Sprintf(&#34;%v&#34;, result) if resultMap, ok := result.(map[string]interface{}); ok { resultBytes, err := json.MarshalIndent(resultMap, &#34;&#34;, &#34; &#34;) if err == nil { resultStr = string(resultBytes) } } // Create prompt for result processing prompt := fmt.Sprintf(`You are processing the result of a tool execution. Format the result in a clear, human-readable way that answers the user&#39;s query. User query: %s Tool used: %s Tool result: %s Provide a concise, helpful response based on this result:`, query, toolName, resultStr) // Get formatted response from LLM return trp.llmProvider.Generate(ctx, prompt) }3. Tool Caching and Performance type CachedTool struct { tool core.Tool cache map[string]CacheEntry cacheTTL time.Duration mu sync.RWMutex } type CacheEntry struct { Result interface{} Timestamp time.Time } func NewCachedTool(tool core.Tool, cacheTTL time.Duration) *CachedTool { return &amp;CachedTool{ tool: tool, cache: make(map[string]CacheEntry), cacheTTL: cacheTTL, } } func (ct *CachedTool) Name() string { return ct.tool.Name() } func (ct *CachedTool) Description() string { return ct.tool.Description() } func (ct *CachedTool) ParameterSchema() map[string]core.ParameterDefinition { return ct.tool.ParameterSchema() } func (ct *CachedTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { // Create cache key from parameters cacheKey := ct.createCacheKey(params) // Check cache if result, found := ct.getCachedResult(cacheKey); found { return result, nil } // Execute tool result, err := ct.tool.Execute(ctx, params) if err != nil { return nil, err } // Cache result ct.setCachedResult(cacheKey, result) return result, nil } func (ct *CachedTool) createCacheKey(params map[string]interface{}) string { // Create deterministic key from parameters keys := make([]string, 0, len(params)) for k := range params { keys = append(keys, k) } sort.Strings(keys) var keyBuilder strings.Builder for _, k := range keys { keyBuilder.WriteString(fmt.Sprintf(&#34;%s:%v;&#34;, k, params[k])) } // Hash the key for consistent length hasher := sha256.New() hasher.Write([]byte(keyBuilder.String())) return fmt.Sprintf(&#34;%x&#34;, hasher.Sum(nil)) } func (ct *CachedTool) getCachedResult(key string) (interface{}, bool) { ct.mu.RLock() defer ct.mu.RUnlock() entry, exists := ct.cache[key] if !exists { return nil, false } // Check if entry is expired if time.Since(entry.Timestamp) &gt; ct.cacheTTL { return nil, false } return entry.Result, true } func (ct *CachedTool) setCachedResult(key string, result interface{}) { ct.mu.Lock() defer ct.mu.Unlock() ct.cache[key] = CacheEntry{ Result: result, Timestamp: time.Now(), } // Clean up expired entries periodically if len(ct.cache)%100 == 0 { go ct.cleanupExpiredEntries() } } func (ct *CachedTool) cleanupExpiredEntries() { ct.mu.Lock() defer ct.mu.Unlock() now := time.Now() for key, entry := range ct.cache { if now.Sub(entry.Timestamp) &gt; ct.cacheTTL { delete(ct.cache, key) } } }Tool Configuration and Management 1. Tool Configuration type ToolConfig struct { Name string `json:&#34;name&#34;` Enabled bool `json:&#34;enabled&#34;` MaxCalls int `json:&#34;max_calls&#34;` Timeout time.Duration `json:&#34;timeout&#34;` RateLimit RateLimitConfig `json:&#34;rate_limit&#34;` Cache CacheConfig `json:&#34;cache&#34;` Parameters map[string]interface{} `json:&#34;parameters&#34;` } type RateLimitConfig struct { MaxRequests int `json:&#34;max_requests&#34;` Interval time.Duration `json:&#34;interval&#34;` } type CacheConfig struct { Enabled bool `json:&#34;enabled&#34;` TTL time.Duration `json:&#34;ttl&#34;` } type ToolManager struct { tools map[string]core.Tool configs map[string]ToolConfig mu sync.RWMutex } func NewToolManager() *ToolManager { return &amp;ToolManager{ tools: make(map[string]core.Tool), configs: make(map[string]ToolConfig), } } func (tm *ToolManager) RegisterTool(tool core.Tool, config ToolConfig) error { tm.mu.Lock() defer tm.mu.Unlock() name := tool.Name() // Apply configuration wrappers wrappedTool := tool // Add caching if enabled if config.Cache.Enabled { wrappedTool = NewCachedTool(wrappedTool, config.Cache.TTL) } // Add rate limiting if configured if config.RateLimit.MaxRequests &gt; 0 { wrappedTool = NewRateLimitedTool(wrappedTool, config.RateLimit.MaxRequests, config.RateLimit.Interval) } // Add validation wrappedTool = NewValidatedTool(wrappedTool, true) tm.tools[name] = wrappedTool tm.configs[name] = config return nil } func (tm *ToolManager) GetTool(name string) (core.Tool, error) { tm.mu.RLock() defer tm.mu.RUnlock() tool, exists := tm.tools[name] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, name) } config := tm.configs[name] if !config.Enabled { return nil, fmt.Errorf(&#34;tool disabled: %s&#34;, name) } return tool, nil } func (tm *ToolManager) ListEnabledTools() []string { tm.mu.RLock() defer tm.mu.RUnlock() var enabled []string for name, config := range tm.configs { if config.Enabled { enabled = append(enabled, name) } } return enabled }2. Tool Discovery and Registration type ToolDiscovery struct { registry map[string]ToolFactory mu sync.RWMutex } type ToolFactory func(config map[string]interface{}) (core.Tool, error) func NewToolDiscovery() *ToolDiscovery { td := &amp;ToolDiscovery{ registry: make(map[string]ToolFactory), } // Register built-in tool factories td.RegisterFactory(&#34;calculator&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCalculatorTool(), nil }) td.RegisterFactory(&#34;weather&#34;, func(config map[string]interface{}) (core.Tool, error) { apiKey, ok := config[&#34;api_key&#34;].(string) if !ok || apiKey == &#34;&#34; { return nil, fmt.Errorf(&#34;weather tool requires api_key parameter&#34;) } return tools.NewWeatherTool(apiKey), nil }) td.RegisterFactory(&#34;counter&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCounterTool(), nil }) return td } func (td *ToolDiscovery) RegisterFactory(name string, factory ToolFactory) { td.mu.Lock() defer td.mu.Unlock() td.registry[name] = factory } func (td *ToolDiscovery) CreateTool(name string, config map[string]interface{}) (core.Tool, error) { td.mu.RLock() factory, exists := td.registry[name] td.mu.RUnlock() if !exists { return nil, fmt.Errorf(&#34;unknown tool type: %s&#34;, name) } return factory(config) } func (td *ToolDiscovery) ListAvailableTools() []string { td.mu.RLock() defer td.mu.RUnlock() tools := make([]string, 0, len(td.registry)) for name := range td.registry { tools = append(tools, name) } return tools }Production Integration Patterns 1. Tool Health Monitoring type ToolHealthMonitor struct { tools map[string]core.Tool metrics map[string]*ToolMetrics mu sync.RWMutex } type ToolMetrics struct { TotalCalls int64 `json:&#34;total_calls&#34;` SuccessCalls int64 `json:&#34;success_calls&#34;` ErrorCalls int64 `json:&#34;error_calls&#34;` AverageTime time.Duration `json:&#34;average_time&#34;` LastError string `json:&#34;last_error&#34;` LastErrorTime time.Time `json:&#34;last_error_time&#34;` } func NewToolHealthMonitor() *ToolHealthMonitor { return &amp;ToolHealthMonitor{ tools: make(map[string]core.Tool), metrics: make(map[string]*ToolMetrics), } } func (thm *ToolHealthMonitor) WrapTool(tool core.Tool) core.Tool { thm.mu.Lock() defer thm.mu.Unlock() name := tool.Name() thm.tools[name] = tool thm.metrics[name] = &amp;ToolMetrics{} return &amp;MonitoredTool{ tool: tool, monitor: thm, } } type MonitoredTool struct { tool core.Tool monitor *ToolHealthMonitor } func (mt *MonitoredTool) Name() string { return mt.tool.Name() } func (mt *MonitoredTool) Description() string { return mt.tool.Description() } func (mt *MonitoredTool) ParameterSchema() map[string]core.ParameterDefinition { return mt.tool.ParameterSchema() } func (mt *MonitoredTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { start := time.Now() name := mt.tool.Name() // Execute tool result, err := mt.tool.Execute(ctx, params) // Record metrics duration := time.Since(start) mt.monitor.recordExecution(name, duration, err) return result, err } func (thm *ToolHealthMonitor) recordExecution(toolName string, duration time.Duration, err error) { thm.mu.Lock() defer thm.mu.Unlock() metrics := thm.metrics[toolName] metrics.TotalCalls&#43;&#43; if err != nil { metrics.ErrorCalls&#43;&#43; metrics.LastError = err.Error() metrics.LastErrorTime = time.Now() } else { metrics.SuccessCalls&#43;&#43; } // Update average time (simple moving average) if metrics.TotalCalls == 1 { metrics.AverageTime = duration } else { metrics.AverageTime = time.Duration( (int64(metrics.AverageTime)*metrics.TotalCalls &#43; int64(duration)) / (metrics.TotalCalls &#43; 1), ) } } func (thm *ToolHealthMonitor) GetMetrics(toolName string) (*ToolMetrics, error) { thm.mu.RLock() defer thm.mu.RUnlock() metrics, exists := thm.metrics[toolName] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, toolName) } // Return a copy to avoid race conditions return &amp;ToolMetrics{ TotalCalls: metrics.TotalCalls, SuccessCalls: metrics.SuccessCalls, ErrorCalls: metrics.ErrorCalls, AverageTime: metrics.AverageTime, LastError: metrics.LastError, LastErrorTime: metrics.LastErrorTime, }, nil } func (thm *ToolHealthMonitor) GetHealthStatus() map[string]string { thm.mu.RLock() defer thm.mu.RUnlock() status := make(map[string]string) for name, metrics := range thm.metrics { if metrics.TotalCalls == 0 { status[name] = &#34;unknown&#34; continue } errorRate := float64(metrics.ErrorCalls) / float64(metrics.TotalCalls) switch { case errorRate == 0: status[name] = &#34;healthy&#34; case errorRate &lt; 0.1: status[name] = &#34;warning&#34; default: status[name] = &#34;unhealthy&#34; } } return status }2. Complete Integration Example package main import ( &#34;context&#34; &#34;encoding/json&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create tool discovery and manager discovery := NewToolDiscovery() manager := NewToolManager() monitor := NewToolHealthMonitor() // Configure tools toolConfigs := []struct { name string config ToolConfig params map[string]interface{} }{ { name: &#34;calculator&#34;, config: ToolConfig{ Name: &#34;calculator&#34;, Enabled: true, MaxCalls: 100, Timeout: 5 * time.Second, Cache: CacheConfig{ Enabled: true, TTL: 1 * time.Hour, }, }, }, { name: &#34;weather&#34;, config: ToolConfig{ Name: &#34;weather&#34;, Enabled: true, MaxCalls: 50, Timeout: 10 * time.Second, RateLimit: RateLimitConfig{ MaxRequests: 10, Interval: 1 * time.Minute, }, Cache: CacheConfig{ Enabled: true, TTL: 15 * time.Minute, }, }, params: map[string]interface{}{ &#34;api_key&#34;: os.Getenv(&#34;WEATHER_API_KEY&#34;), }, }, } // Create and register tools for _, tc := range toolConfigs { tool, err := discovery.CreateTool(tc.name, tc.params) if err != nil { log.Fatalf(&#34;Failed to create tool %s: %v&#34;, tc.name, err) } // Wrap with monitoring monitoredTool := monitor.WrapTool(tool) // Register with manager if err := manager.RegisterTool(monitoredTool, tc.config); err != nil { log.Fatalf(&#34;Failed to register tool %s: %v&#34;, tc.name, err) } } // Create MCP manager and register tools mcpManager := core.NewMCPManager() for _, toolName := range manager.ListEnabledTools() { tool, err := manager.GetTool(toolName) if err != nil { log.Printf(&#34;Failed to get tool %s: %v&#34;, toolName, err) continue } mcpManager.RegisterTool(toolName, tool) } // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: manager.ListEnabledTools(), MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner with tool monitoring runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Setup tool result handling setupToolResultHandling(runner) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Example interaction event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;Calculate 15 * 23 and tell me the weather in London&#34;}, map[string]string{&#34;session_id&#34;: &#34;demo-session&#34;}, ) runner.Emit(event) // Wait and show metrics time.Sleep(10 * time.Second) // Display tool health metrics fmt.Println(&#34;\nTool Health Status:&#34;) healthStatus := monitor.GetHealthStatus() for tool, status := range healthStatus { fmt.Printf(&#34;- %s: %s\n&#34;, tool, status) if metrics, err := monitor.GetMetrics(tool); err == nil { fmt.Printf(&#34; Calls: %d (Success: %d, Errors: %d)\n&#34;, metrics.TotalCalls, metrics.SuccessCalls, metrics.ErrorCalls) fmt.Printf(&#34; Average Time: %v\n&#34;, metrics.AverageTime) if metrics.LastError != &#34;&#34; { fmt.Printf(&#34; Last Error: %s (%v)\n&#34;, metrics.LastError, metrics.LastErrorTime) } } } }Best Practices 1. Tool Integration Guidelines Selective Tool Access: Only provide agents with tools they actually need Tool Validation: Always validate tool parameters and results Error Handling: Implement robust error handling and recovery Performance Monitoring: Monitor tool performance and health Security: Implement proper authentication and authorization Caching: Use caching for expensive or frequently called tools Rate Limiting: Protect external services with rate limiting 2. Prompting Best Practices Clear Tool Descriptions: Provide clear, concise tool descriptions Parameter Documentation: Document all parameters with examples Usage Examples: Include examples of when and how to use tools Error Guidance: Explain how to handle tool errors Tool Selection: Guide the agent on tool selection criteria 3. Production Considerations Monitoring: Implement comprehensive tool monitoring Logging: Log all tool executions for debugging Metrics: Track tool usage and performance metrics Health Checks: Implement tool health checking Fallbacks: Provide fallback mechanisms for tool failures Configuration: Make tool configuration externally manageable Troubleshooting Common Issues Tool Not Found: Ensure tools are properly registered with the MCP manager Parameter Validation Errors: Check parameter schemas and validation rules Timeout Errors: Adjust tool timeout settings for slow operations Rate Limit Exceeded: Configure appropriate rate limits for external services Authentication Failures: Verify API keys and authentication credentials Debugging Tips Enable detailed logging for tool executions Use tool health monitoring to identify problematic tools Test tools independently before integrating with agents Monitor tool performance metrics regularly Implement proper error handling and recovery mechanisms Conclusion Tool integration is a powerful feature that extends agent capabilities beyond text generation. By following the patterns and best practices in this tutorial, you can create robust, scalable tool integrations that enhance your agent systems.">
    <meta property="og:url" content="http://localhost:1313/AgenticGoKitDocs/tutorials/mcp/tool-integration/index.html">
    <meta property="og:site_name" content="AgenticGoKit Docs">
    <meta property="og:title" content="tool-integration :: AgenticGoKit Docs">
    <meta property="og:description" content="Tool Integration in AgenticGoKit Overview Integrating tools with agents is a key capability in AgenticGoKit that enables agents to perform actions beyond text generation. This tutorial covers how to connect tools to agents, configure tool access, handle tool results, and implement tool-aware prompting.
Effective tool integration allows agents to interact with external systems, access specialized information, and perform complex tasks while maintaining a natural conversation flow.
Prerequisites Understanding of MCP Overview Familiarity with Tool Development Knowledge of Agent Lifecycle Basic understanding of State Management MCP Integration Architecture ┌─────────────┐ ┌───────────────┐ ┌─────────────┐│ │ │ │ │ ││ Agent │────▶│ MCP Manager │────▶│ Tool ││ │ │ │ │ │└─────────────┘ └───────────────┘ └─────────────┘▲ │ ││ ▼ ▼│ ┌───────────────┐ ┌─────────────┐└──────────────│ Tool Result │◀───│ External ││ Processor │ │ Service │└───────────────┘ └─────────────┘Basic Tool Integration 1. Setting Up MCP Manager package main import ( &#34;context&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) mcpManager.RegisterTool(&#34;counter&#34;, tools.NewCounterTool()) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent with MCP capability agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;, &#34;counter&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Create event with user query event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;What&#39;s 25 * 16 and what&#39;s the weather in New York?&#34;}, map[string]string{&#34;session_id&#34;: &#34;test-session&#34;}, ) // Register callback to handle agent response runner.RegisterCallback(core.HookAfterAgentRun, &#34;response-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { if response, ok := args.AgentResult.OutputState.Get(&#34;response&#34;); ok { fmt.Printf(&#34;Agent response: %s\n&#34;, response) } return args.State, nil }, ) // Emit event runner.Emit(event) // Wait for response time.Sleep(5 * time.Second) }2. Tool-Aware Prompting func createToolAwareAgent() (core.AgentHandler, error) { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { return nil, fmt.Errorf(&#34;failed to create LLM provider: %w&#34;, err) } // Create tool-aware system prompt systemPrompt := `You are a helpful assistant with access to the following tools: 1. calculator: Performs basic arithmetic operations (add, subtract, multiply, divide) - Parameters: operation (string), a (number), b (number) 2. weather: Gets current weather information for a specified location - Parameters: location (string), units (string, optional) When you need to use a tool, use the following format: &lt;tool&gt;calculator&lt;/tool&gt; &lt;parameters&gt; { &#34;operation&#34;: &#34;add&#34;, &#34;a&#34;: 5, &#34;b&#34;: 3 } &lt;/parameters&gt; Wait for the tool result before continuing. Tool results will be provided in this format: &lt;tool_result&gt; { &#34;result&#34;: 8 } &lt;/tool_result&gt; Answer user questions directly when you can, and use tools when necessary.` // Create agent with MCP capability and tool-aware prompt return core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithSystemPrompt(systemPrompt). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() }3. Handling Tool Results func setupToolResultHandling(runner *core.Runner) { // Register callback for tool execution runner.RegisterCallback(core.HookBeforeToolExecution, &#34;tool-execution-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolParams := args.ToolParams fmt.Printf(&#34;Executing tool: %s with params: %v\n&#34;, toolName, toolParams) return args.State, nil }, ) // Register callback for tool result runner.RegisterCallback(core.HookAfterToolExecution, &#34;tool-result-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolResult := args.ToolResult toolError := args.Error if toolError != nil { fmt.Printf(&#34;Tool %s failed: %v\n&#34;, toolName, toolError) } else { fmt.Printf(&#34;Tool %s result: %v\n&#34;, toolName, toolResult) } return args.State, nil }, ) // Register callback for tool error runner.RegisterCallback(core.HookToolError, &#34;tool-error-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolError := args.Error fmt.Printf(&#34;Tool error: %s - %v\n&#34;, toolName, toolError) // Add error information to state newState := args.State.Clone() newState.Set(&#34;tool_error&#34;, fmt.Sprintf(&#34;The %s tool encountered an error: %v&#34;, toolName, toolError)) return newState, nil }, ) }Advanced Tool Integration 1. Dynamic Tool Selection type DynamicToolSelector struct { tools map[string]core.Tool llmProvider core.LLMProvider } func NewDynamicToolSelector(llmProvider core.LLMProvider) *DynamicToolSelector { return &amp;DynamicToolSelector{ tools: make(map[string]core.Tool), llmProvider: llmProvider, } } func (dts *DynamicToolSelector) RegisterTool(name string, tool core.Tool) { dts.tools[name] = tool } func (dts *DynamicToolSelector) SelectTools(ctx context.Context, query string) ([]string, error) { // Create tool descriptions var toolDescriptions strings.Builder for name, tool := range dts.tools { toolDescriptions.WriteString(fmt.Sprintf(&#34;- %s: %s\n&#34;, name, tool.Description())) } // Create prompt for tool selection prompt := fmt.Sprintf(`Given the following user query and available tools, select the most appropriate tools to answer the query. User query: %s Available tools: %s Return only the names of the tools that should be used, separated by commas (e.g., &#34;calculator,weather&#34;). If no tools are needed, return &#34;none&#34;. Selected tools:`, query, toolDescriptions.String()) // Get tool selection from LLM response, err := dts.llmProvider.Generate(ctx, prompt) if err != nil { return nil, fmt.Errorf(&#34;tool selection failed: %w&#34;, err) } // Parse response response = strings.TrimSpace(response) if response == &#34;none&#34; { return []string{}, nil } // Split by comma and trim spaces selectedTools := strings.Split(response, &#34;,&#34;) for i := range selectedTools { selectedTools[i] = strings.TrimSpace(selectedTools[i]) } // Validate selected tools validTools := make([]string, 0, len(selectedTools)) for _, name := range selectedTools { if _, exists := dts.tools[name]; exists { validTools = append(validTools, name) } } return validTools, nil }2. Tool Result Processing type ToolResultProcessor struct { llmProvider core.LLMProvider } func NewToolResultProcessor(llmProvider core.LLMProvider) *ToolResultProcessor { return &amp;ToolResultProcessor{ llmProvider: llmProvider, } } func (trp *ToolResultProcessor) ProcessResult(ctx context.Context, toolName string, result interface{}, query string) (string, error) { // Convert result to string representation resultStr := fmt.Sprintf(&#34;%v&#34;, result) if resultMap, ok := result.(map[string]interface{}); ok { resultBytes, err := json.MarshalIndent(resultMap, &#34;&#34;, &#34; &#34;) if err == nil { resultStr = string(resultBytes) } } // Create prompt for result processing prompt := fmt.Sprintf(`You are processing the result of a tool execution. Format the result in a clear, human-readable way that answers the user&#39;s query. User query: %s Tool used: %s Tool result: %s Provide a concise, helpful response based on this result:`, query, toolName, resultStr) // Get formatted response from LLM return trp.llmProvider.Generate(ctx, prompt) }3. Tool Caching and Performance type CachedTool struct { tool core.Tool cache map[string]CacheEntry cacheTTL time.Duration mu sync.RWMutex } type CacheEntry struct { Result interface{} Timestamp time.Time } func NewCachedTool(tool core.Tool, cacheTTL time.Duration) *CachedTool { return &amp;CachedTool{ tool: tool, cache: make(map[string]CacheEntry), cacheTTL: cacheTTL, } } func (ct *CachedTool) Name() string { return ct.tool.Name() } func (ct *CachedTool) Description() string { return ct.tool.Description() } func (ct *CachedTool) ParameterSchema() map[string]core.ParameterDefinition { return ct.tool.ParameterSchema() } func (ct *CachedTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { // Create cache key from parameters cacheKey := ct.createCacheKey(params) // Check cache if result, found := ct.getCachedResult(cacheKey); found { return result, nil } // Execute tool result, err := ct.tool.Execute(ctx, params) if err != nil { return nil, err } // Cache result ct.setCachedResult(cacheKey, result) return result, nil } func (ct *CachedTool) createCacheKey(params map[string]interface{}) string { // Create deterministic key from parameters keys := make([]string, 0, len(params)) for k := range params { keys = append(keys, k) } sort.Strings(keys) var keyBuilder strings.Builder for _, k := range keys { keyBuilder.WriteString(fmt.Sprintf(&#34;%s:%v;&#34;, k, params[k])) } // Hash the key for consistent length hasher := sha256.New() hasher.Write([]byte(keyBuilder.String())) return fmt.Sprintf(&#34;%x&#34;, hasher.Sum(nil)) } func (ct *CachedTool) getCachedResult(key string) (interface{}, bool) { ct.mu.RLock() defer ct.mu.RUnlock() entry, exists := ct.cache[key] if !exists { return nil, false } // Check if entry is expired if time.Since(entry.Timestamp) &gt; ct.cacheTTL { return nil, false } return entry.Result, true } func (ct *CachedTool) setCachedResult(key string, result interface{}) { ct.mu.Lock() defer ct.mu.Unlock() ct.cache[key] = CacheEntry{ Result: result, Timestamp: time.Now(), } // Clean up expired entries periodically if len(ct.cache)%100 == 0 { go ct.cleanupExpiredEntries() } } func (ct *CachedTool) cleanupExpiredEntries() { ct.mu.Lock() defer ct.mu.Unlock() now := time.Now() for key, entry := range ct.cache { if now.Sub(entry.Timestamp) &gt; ct.cacheTTL { delete(ct.cache, key) } } }Tool Configuration and Management 1. Tool Configuration type ToolConfig struct { Name string `json:&#34;name&#34;` Enabled bool `json:&#34;enabled&#34;` MaxCalls int `json:&#34;max_calls&#34;` Timeout time.Duration `json:&#34;timeout&#34;` RateLimit RateLimitConfig `json:&#34;rate_limit&#34;` Cache CacheConfig `json:&#34;cache&#34;` Parameters map[string]interface{} `json:&#34;parameters&#34;` } type RateLimitConfig struct { MaxRequests int `json:&#34;max_requests&#34;` Interval time.Duration `json:&#34;interval&#34;` } type CacheConfig struct { Enabled bool `json:&#34;enabled&#34;` TTL time.Duration `json:&#34;ttl&#34;` } type ToolManager struct { tools map[string]core.Tool configs map[string]ToolConfig mu sync.RWMutex } func NewToolManager() *ToolManager { return &amp;ToolManager{ tools: make(map[string]core.Tool), configs: make(map[string]ToolConfig), } } func (tm *ToolManager) RegisterTool(tool core.Tool, config ToolConfig) error { tm.mu.Lock() defer tm.mu.Unlock() name := tool.Name() // Apply configuration wrappers wrappedTool := tool // Add caching if enabled if config.Cache.Enabled { wrappedTool = NewCachedTool(wrappedTool, config.Cache.TTL) } // Add rate limiting if configured if config.RateLimit.MaxRequests &gt; 0 { wrappedTool = NewRateLimitedTool(wrappedTool, config.RateLimit.MaxRequests, config.RateLimit.Interval) } // Add validation wrappedTool = NewValidatedTool(wrappedTool, true) tm.tools[name] = wrappedTool tm.configs[name] = config return nil } func (tm *ToolManager) GetTool(name string) (core.Tool, error) { tm.mu.RLock() defer tm.mu.RUnlock() tool, exists := tm.tools[name] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, name) } config := tm.configs[name] if !config.Enabled { return nil, fmt.Errorf(&#34;tool disabled: %s&#34;, name) } return tool, nil } func (tm *ToolManager) ListEnabledTools() []string { tm.mu.RLock() defer tm.mu.RUnlock() var enabled []string for name, config := range tm.configs { if config.Enabled { enabled = append(enabled, name) } } return enabled }2. Tool Discovery and Registration type ToolDiscovery struct { registry map[string]ToolFactory mu sync.RWMutex } type ToolFactory func(config map[string]interface{}) (core.Tool, error) func NewToolDiscovery() *ToolDiscovery { td := &amp;ToolDiscovery{ registry: make(map[string]ToolFactory), } // Register built-in tool factories td.RegisterFactory(&#34;calculator&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCalculatorTool(), nil }) td.RegisterFactory(&#34;weather&#34;, func(config map[string]interface{}) (core.Tool, error) { apiKey, ok := config[&#34;api_key&#34;].(string) if !ok || apiKey == &#34;&#34; { return nil, fmt.Errorf(&#34;weather tool requires api_key parameter&#34;) } return tools.NewWeatherTool(apiKey), nil }) td.RegisterFactory(&#34;counter&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCounterTool(), nil }) return td } func (td *ToolDiscovery) RegisterFactory(name string, factory ToolFactory) { td.mu.Lock() defer td.mu.Unlock() td.registry[name] = factory } func (td *ToolDiscovery) CreateTool(name string, config map[string]interface{}) (core.Tool, error) { td.mu.RLock() factory, exists := td.registry[name] td.mu.RUnlock() if !exists { return nil, fmt.Errorf(&#34;unknown tool type: %s&#34;, name) } return factory(config) } func (td *ToolDiscovery) ListAvailableTools() []string { td.mu.RLock() defer td.mu.RUnlock() tools := make([]string, 0, len(td.registry)) for name := range td.registry { tools = append(tools, name) } return tools }Production Integration Patterns 1. Tool Health Monitoring type ToolHealthMonitor struct { tools map[string]core.Tool metrics map[string]*ToolMetrics mu sync.RWMutex } type ToolMetrics struct { TotalCalls int64 `json:&#34;total_calls&#34;` SuccessCalls int64 `json:&#34;success_calls&#34;` ErrorCalls int64 `json:&#34;error_calls&#34;` AverageTime time.Duration `json:&#34;average_time&#34;` LastError string `json:&#34;last_error&#34;` LastErrorTime time.Time `json:&#34;last_error_time&#34;` } func NewToolHealthMonitor() *ToolHealthMonitor { return &amp;ToolHealthMonitor{ tools: make(map[string]core.Tool), metrics: make(map[string]*ToolMetrics), } } func (thm *ToolHealthMonitor) WrapTool(tool core.Tool) core.Tool { thm.mu.Lock() defer thm.mu.Unlock() name := tool.Name() thm.tools[name] = tool thm.metrics[name] = &amp;ToolMetrics{} return &amp;MonitoredTool{ tool: tool, monitor: thm, } } type MonitoredTool struct { tool core.Tool monitor *ToolHealthMonitor } func (mt *MonitoredTool) Name() string { return mt.tool.Name() } func (mt *MonitoredTool) Description() string { return mt.tool.Description() } func (mt *MonitoredTool) ParameterSchema() map[string]core.ParameterDefinition { return mt.tool.ParameterSchema() } func (mt *MonitoredTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { start := time.Now() name := mt.tool.Name() // Execute tool result, err := mt.tool.Execute(ctx, params) // Record metrics duration := time.Since(start) mt.monitor.recordExecution(name, duration, err) return result, err } func (thm *ToolHealthMonitor) recordExecution(toolName string, duration time.Duration, err error) { thm.mu.Lock() defer thm.mu.Unlock() metrics := thm.metrics[toolName] metrics.TotalCalls&#43;&#43; if err != nil { metrics.ErrorCalls&#43;&#43; metrics.LastError = err.Error() metrics.LastErrorTime = time.Now() } else { metrics.SuccessCalls&#43;&#43; } // Update average time (simple moving average) if metrics.TotalCalls == 1 { metrics.AverageTime = duration } else { metrics.AverageTime = time.Duration( (int64(metrics.AverageTime)*metrics.TotalCalls &#43; int64(duration)) / (metrics.TotalCalls &#43; 1), ) } } func (thm *ToolHealthMonitor) GetMetrics(toolName string) (*ToolMetrics, error) { thm.mu.RLock() defer thm.mu.RUnlock() metrics, exists := thm.metrics[toolName] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, toolName) } // Return a copy to avoid race conditions return &amp;ToolMetrics{ TotalCalls: metrics.TotalCalls, SuccessCalls: metrics.SuccessCalls, ErrorCalls: metrics.ErrorCalls, AverageTime: metrics.AverageTime, LastError: metrics.LastError, LastErrorTime: metrics.LastErrorTime, }, nil } func (thm *ToolHealthMonitor) GetHealthStatus() map[string]string { thm.mu.RLock() defer thm.mu.RUnlock() status := make(map[string]string) for name, metrics := range thm.metrics { if metrics.TotalCalls == 0 { status[name] = &#34;unknown&#34; continue } errorRate := float64(metrics.ErrorCalls) / float64(metrics.TotalCalls) switch { case errorRate == 0: status[name] = &#34;healthy&#34; case errorRate &lt; 0.1: status[name] = &#34;warning&#34; default: status[name] = &#34;unhealthy&#34; } } return status }2. Complete Integration Example package main import ( &#34;context&#34; &#34;encoding/json&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create tool discovery and manager discovery := NewToolDiscovery() manager := NewToolManager() monitor := NewToolHealthMonitor() // Configure tools toolConfigs := []struct { name string config ToolConfig params map[string]interface{} }{ { name: &#34;calculator&#34;, config: ToolConfig{ Name: &#34;calculator&#34;, Enabled: true, MaxCalls: 100, Timeout: 5 * time.Second, Cache: CacheConfig{ Enabled: true, TTL: 1 * time.Hour, }, }, }, { name: &#34;weather&#34;, config: ToolConfig{ Name: &#34;weather&#34;, Enabled: true, MaxCalls: 50, Timeout: 10 * time.Second, RateLimit: RateLimitConfig{ MaxRequests: 10, Interval: 1 * time.Minute, }, Cache: CacheConfig{ Enabled: true, TTL: 15 * time.Minute, }, }, params: map[string]interface{}{ &#34;api_key&#34;: os.Getenv(&#34;WEATHER_API_KEY&#34;), }, }, } // Create and register tools for _, tc := range toolConfigs { tool, err := discovery.CreateTool(tc.name, tc.params) if err != nil { log.Fatalf(&#34;Failed to create tool %s: %v&#34;, tc.name, err) } // Wrap with monitoring monitoredTool := monitor.WrapTool(tool) // Register with manager if err := manager.RegisterTool(monitoredTool, tc.config); err != nil { log.Fatalf(&#34;Failed to register tool %s: %v&#34;, tc.name, err) } } // Create MCP manager and register tools mcpManager := core.NewMCPManager() for _, toolName := range manager.ListEnabledTools() { tool, err := manager.GetTool(toolName) if err != nil { log.Printf(&#34;Failed to get tool %s: %v&#34;, toolName, err) continue } mcpManager.RegisterTool(toolName, tool) } // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: manager.ListEnabledTools(), MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner with tool monitoring runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Setup tool result handling setupToolResultHandling(runner) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Example interaction event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;Calculate 15 * 23 and tell me the weather in London&#34;}, map[string]string{&#34;session_id&#34;: &#34;demo-session&#34;}, ) runner.Emit(event) // Wait and show metrics time.Sleep(10 * time.Second) // Display tool health metrics fmt.Println(&#34;\nTool Health Status:&#34;) healthStatus := monitor.GetHealthStatus() for tool, status := range healthStatus { fmt.Printf(&#34;- %s: %s\n&#34;, tool, status) if metrics, err := monitor.GetMetrics(tool); err == nil { fmt.Printf(&#34; Calls: %d (Success: %d, Errors: %d)\n&#34;, metrics.TotalCalls, metrics.SuccessCalls, metrics.ErrorCalls) fmt.Printf(&#34; Average Time: %v\n&#34;, metrics.AverageTime) if metrics.LastError != &#34;&#34; { fmt.Printf(&#34; Last Error: %s (%v)\n&#34;, metrics.LastError, metrics.LastErrorTime) } } } }Best Practices 1. Tool Integration Guidelines Selective Tool Access: Only provide agents with tools they actually need Tool Validation: Always validate tool parameters and results Error Handling: Implement robust error handling and recovery Performance Monitoring: Monitor tool performance and health Security: Implement proper authentication and authorization Caching: Use caching for expensive or frequently called tools Rate Limiting: Protect external services with rate limiting 2. Prompting Best Practices Clear Tool Descriptions: Provide clear, concise tool descriptions Parameter Documentation: Document all parameters with examples Usage Examples: Include examples of when and how to use tools Error Guidance: Explain how to handle tool errors Tool Selection: Guide the agent on tool selection criteria 3. Production Considerations Monitoring: Implement comprehensive tool monitoring Logging: Log all tool executions for debugging Metrics: Track tool usage and performance metrics Health Checks: Implement tool health checking Fallbacks: Provide fallback mechanisms for tool failures Configuration: Make tool configuration externally manageable Troubleshooting Common Issues Tool Not Found: Ensure tools are properly registered with the MCP manager Parameter Validation Errors: Check parameter schemas and validation rules Timeout Errors: Adjust tool timeout settings for slow operations Rate Limit Exceeded: Configure appropriate rate limits for external services Authentication Failures: Verify API keys and authentication credentials Debugging Tips Enable detailed logging for tool executions Use tool health monitoring to identify problematic tools Test tools independently before integrating with agents Monitor tool performance metrics regularly Implement proper error handling and recovery mechanisms Conclusion Tool integration is a powerful feature that extends agent capabilities beyond text generation. By following the patterns and best practices in this tutorial, you can create robust, scalable tool integrations that enhance your agent systems.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="tutorials">
    <meta property="article:published_time" content="2025-07-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-25T00:00:00+00:00">
    <meta itemprop="name" content="tool-integration :: AgenticGoKit Docs">
    <meta itemprop="description" content="Tool Integration in AgenticGoKit Overview Integrating tools with agents is a key capability in AgenticGoKit that enables agents to perform actions beyond text generation. This tutorial covers how to connect tools to agents, configure tool access, handle tool results, and implement tool-aware prompting.
Effective tool integration allows agents to interact with external systems, access specialized information, and perform complex tasks while maintaining a natural conversation flow.
Prerequisites Understanding of MCP Overview Familiarity with Tool Development Knowledge of Agent Lifecycle Basic understanding of State Management MCP Integration Architecture ┌─────────────┐ ┌───────────────┐ ┌─────────────┐│ │ │ │ │ ││ Agent │────▶│ MCP Manager │────▶│ Tool ││ │ │ │ │ │└─────────────┘ └───────────────┘ └─────────────┘▲ │ ││ ▼ ▼│ ┌───────────────┐ ┌─────────────┐└──────────────│ Tool Result │◀───│ External ││ Processor │ │ Service │└───────────────┘ └─────────────┘Basic Tool Integration 1. Setting Up MCP Manager package main import ( &#34;context&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) mcpManager.RegisterTool(&#34;counter&#34;, tools.NewCounterTool()) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent with MCP capability agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;, &#34;counter&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Create event with user query event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;What&#39;s 25 * 16 and what&#39;s the weather in New York?&#34;}, map[string]string{&#34;session_id&#34;: &#34;test-session&#34;}, ) // Register callback to handle agent response runner.RegisterCallback(core.HookAfterAgentRun, &#34;response-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { if response, ok := args.AgentResult.OutputState.Get(&#34;response&#34;); ok { fmt.Printf(&#34;Agent response: %s\n&#34;, response) } return args.State, nil }, ) // Emit event runner.Emit(event) // Wait for response time.Sleep(5 * time.Second) }2. Tool-Aware Prompting func createToolAwareAgent() (core.AgentHandler, error) { // Create MCP manager mcpManager := core.NewMCPManager() // Register tools mcpManager.RegisterTool(&#34;calculator&#34;, tools.NewCalculatorTool()) mcpManager.RegisterTool(&#34;weather&#34;, tools.NewWeatherTool(os.Getenv(&#34;WEATHER_API_KEY&#34;))) // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { return nil, fmt.Errorf(&#34;failed to create LLM provider: %w&#34;, err) } // Create tool-aware system prompt systemPrompt := `You are a helpful assistant with access to the following tools: 1. calculator: Performs basic arithmetic operations (add, subtract, multiply, divide) - Parameters: operation (string), a (number), b (number) 2. weather: Gets current weather information for a specified location - Parameters: location (string), units (string, optional) When you need to use a tool, use the following format: &lt;tool&gt;calculator&lt;/tool&gt; &lt;parameters&gt; { &#34;operation&#34;: &#34;add&#34;, &#34;a&#34;: 5, &#34;b&#34;: 3 } &lt;/parameters&gt; Wait for the tool result before continuing. Tool results will be provided in this format: &lt;tool_result&gt; { &#34;result&#34;: 8 } &lt;/tool_result&gt; Answer user questions directly when you can, and use tools when necessary.` // Create agent with MCP capability and tool-aware prompt return core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithSystemPrompt(systemPrompt). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: []string{&#34;calculator&#34;, &#34;weather&#34;}, MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() }3. Handling Tool Results func setupToolResultHandling(runner *core.Runner) { // Register callback for tool execution runner.RegisterCallback(core.HookBeforeToolExecution, &#34;tool-execution-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolParams := args.ToolParams fmt.Printf(&#34;Executing tool: %s with params: %v\n&#34;, toolName, toolParams) return args.State, nil }, ) // Register callback for tool result runner.RegisterCallback(core.HookAfterToolExecution, &#34;tool-result-logger&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolResult := args.ToolResult toolError := args.Error if toolError != nil { fmt.Printf(&#34;Tool %s failed: %v\n&#34;, toolName, toolError) } else { fmt.Printf(&#34;Tool %s result: %v\n&#34;, toolName, toolResult) } return args.State, nil }, ) // Register callback for tool error runner.RegisterCallback(core.HookToolError, &#34;tool-error-handler&#34;, func(ctx context.Context, args core.CallbackArgs) (core.State, error) { toolName := args.ToolName toolError := args.Error fmt.Printf(&#34;Tool error: %s - %v\n&#34;, toolName, toolError) // Add error information to state newState := args.State.Clone() newState.Set(&#34;tool_error&#34;, fmt.Sprintf(&#34;The %s tool encountered an error: %v&#34;, toolName, toolError)) return newState, nil }, ) }Advanced Tool Integration 1. Dynamic Tool Selection type DynamicToolSelector struct { tools map[string]core.Tool llmProvider core.LLMProvider } func NewDynamicToolSelector(llmProvider core.LLMProvider) *DynamicToolSelector { return &amp;DynamicToolSelector{ tools: make(map[string]core.Tool), llmProvider: llmProvider, } } func (dts *DynamicToolSelector) RegisterTool(name string, tool core.Tool) { dts.tools[name] = tool } func (dts *DynamicToolSelector) SelectTools(ctx context.Context, query string) ([]string, error) { // Create tool descriptions var toolDescriptions strings.Builder for name, tool := range dts.tools { toolDescriptions.WriteString(fmt.Sprintf(&#34;- %s: %s\n&#34;, name, tool.Description())) } // Create prompt for tool selection prompt := fmt.Sprintf(`Given the following user query and available tools, select the most appropriate tools to answer the query. User query: %s Available tools: %s Return only the names of the tools that should be used, separated by commas (e.g., &#34;calculator,weather&#34;). If no tools are needed, return &#34;none&#34;. Selected tools:`, query, toolDescriptions.String()) // Get tool selection from LLM response, err := dts.llmProvider.Generate(ctx, prompt) if err != nil { return nil, fmt.Errorf(&#34;tool selection failed: %w&#34;, err) } // Parse response response = strings.TrimSpace(response) if response == &#34;none&#34; { return []string{}, nil } // Split by comma and trim spaces selectedTools := strings.Split(response, &#34;,&#34;) for i := range selectedTools { selectedTools[i] = strings.TrimSpace(selectedTools[i]) } // Validate selected tools validTools := make([]string, 0, len(selectedTools)) for _, name := range selectedTools { if _, exists := dts.tools[name]; exists { validTools = append(validTools, name) } } return validTools, nil }2. Tool Result Processing type ToolResultProcessor struct { llmProvider core.LLMProvider } func NewToolResultProcessor(llmProvider core.LLMProvider) *ToolResultProcessor { return &amp;ToolResultProcessor{ llmProvider: llmProvider, } } func (trp *ToolResultProcessor) ProcessResult(ctx context.Context, toolName string, result interface{}, query string) (string, error) { // Convert result to string representation resultStr := fmt.Sprintf(&#34;%v&#34;, result) if resultMap, ok := result.(map[string]interface{}); ok { resultBytes, err := json.MarshalIndent(resultMap, &#34;&#34;, &#34; &#34;) if err == nil { resultStr = string(resultBytes) } } // Create prompt for result processing prompt := fmt.Sprintf(`You are processing the result of a tool execution. Format the result in a clear, human-readable way that answers the user&#39;s query. User query: %s Tool used: %s Tool result: %s Provide a concise, helpful response based on this result:`, query, toolName, resultStr) // Get formatted response from LLM return trp.llmProvider.Generate(ctx, prompt) }3. Tool Caching and Performance type CachedTool struct { tool core.Tool cache map[string]CacheEntry cacheTTL time.Duration mu sync.RWMutex } type CacheEntry struct { Result interface{} Timestamp time.Time } func NewCachedTool(tool core.Tool, cacheTTL time.Duration) *CachedTool { return &amp;CachedTool{ tool: tool, cache: make(map[string]CacheEntry), cacheTTL: cacheTTL, } } func (ct *CachedTool) Name() string { return ct.tool.Name() } func (ct *CachedTool) Description() string { return ct.tool.Description() } func (ct *CachedTool) ParameterSchema() map[string]core.ParameterDefinition { return ct.tool.ParameterSchema() } func (ct *CachedTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { // Create cache key from parameters cacheKey := ct.createCacheKey(params) // Check cache if result, found := ct.getCachedResult(cacheKey); found { return result, nil } // Execute tool result, err := ct.tool.Execute(ctx, params) if err != nil { return nil, err } // Cache result ct.setCachedResult(cacheKey, result) return result, nil } func (ct *CachedTool) createCacheKey(params map[string]interface{}) string { // Create deterministic key from parameters keys := make([]string, 0, len(params)) for k := range params { keys = append(keys, k) } sort.Strings(keys) var keyBuilder strings.Builder for _, k := range keys { keyBuilder.WriteString(fmt.Sprintf(&#34;%s:%v;&#34;, k, params[k])) } // Hash the key for consistent length hasher := sha256.New() hasher.Write([]byte(keyBuilder.String())) return fmt.Sprintf(&#34;%x&#34;, hasher.Sum(nil)) } func (ct *CachedTool) getCachedResult(key string) (interface{}, bool) { ct.mu.RLock() defer ct.mu.RUnlock() entry, exists := ct.cache[key] if !exists { return nil, false } // Check if entry is expired if time.Since(entry.Timestamp) &gt; ct.cacheTTL { return nil, false } return entry.Result, true } func (ct *CachedTool) setCachedResult(key string, result interface{}) { ct.mu.Lock() defer ct.mu.Unlock() ct.cache[key] = CacheEntry{ Result: result, Timestamp: time.Now(), } // Clean up expired entries periodically if len(ct.cache)%100 == 0 { go ct.cleanupExpiredEntries() } } func (ct *CachedTool) cleanupExpiredEntries() { ct.mu.Lock() defer ct.mu.Unlock() now := time.Now() for key, entry := range ct.cache { if now.Sub(entry.Timestamp) &gt; ct.cacheTTL { delete(ct.cache, key) } } }Tool Configuration and Management 1. Tool Configuration type ToolConfig struct { Name string `json:&#34;name&#34;` Enabled bool `json:&#34;enabled&#34;` MaxCalls int `json:&#34;max_calls&#34;` Timeout time.Duration `json:&#34;timeout&#34;` RateLimit RateLimitConfig `json:&#34;rate_limit&#34;` Cache CacheConfig `json:&#34;cache&#34;` Parameters map[string]interface{} `json:&#34;parameters&#34;` } type RateLimitConfig struct { MaxRequests int `json:&#34;max_requests&#34;` Interval time.Duration `json:&#34;interval&#34;` } type CacheConfig struct { Enabled bool `json:&#34;enabled&#34;` TTL time.Duration `json:&#34;ttl&#34;` } type ToolManager struct { tools map[string]core.Tool configs map[string]ToolConfig mu sync.RWMutex } func NewToolManager() *ToolManager { return &amp;ToolManager{ tools: make(map[string]core.Tool), configs: make(map[string]ToolConfig), } } func (tm *ToolManager) RegisterTool(tool core.Tool, config ToolConfig) error { tm.mu.Lock() defer tm.mu.Unlock() name := tool.Name() // Apply configuration wrappers wrappedTool := tool // Add caching if enabled if config.Cache.Enabled { wrappedTool = NewCachedTool(wrappedTool, config.Cache.TTL) } // Add rate limiting if configured if config.RateLimit.MaxRequests &gt; 0 { wrappedTool = NewRateLimitedTool(wrappedTool, config.RateLimit.MaxRequests, config.RateLimit.Interval) } // Add validation wrappedTool = NewValidatedTool(wrappedTool, true) tm.tools[name] = wrappedTool tm.configs[name] = config return nil } func (tm *ToolManager) GetTool(name string) (core.Tool, error) { tm.mu.RLock() defer tm.mu.RUnlock() tool, exists := tm.tools[name] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, name) } config := tm.configs[name] if !config.Enabled { return nil, fmt.Errorf(&#34;tool disabled: %s&#34;, name) } return tool, nil } func (tm *ToolManager) ListEnabledTools() []string { tm.mu.RLock() defer tm.mu.RUnlock() var enabled []string for name, config := range tm.configs { if config.Enabled { enabled = append(enabled, name) } } return enabled }2. Tool Discovery and Registration type ToolDiscovery struct { registry map[string]ToolFactory mu sync.RWMutex } type ToolFactory func(config map[string]interface{}) (core.Tool, error) func NewToolDiscovery() *ToolDiscovery { td := &amp;ToolDiscovery{ registry: make(map[string]ToolFactory), } // Register built-in tool factories td.RegisterFactory(&#34;calculator&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCalculatorTool(), nil }) td.RegisterFactory(&#34;weather&#34;, func(config map[string]interface{}) (core.Tool, error) { apiKey, ok := config[&#34;api_key&#34;].(string) if !ok || apiKey == &#34;&#34; { return nil, fmt.Errorf(&#34;weather tool requires api_key parameter&#34;) } return tools.NewWeatherTool(apiKey), nil }) td.RegisterFactory(&#34;counter&#34;, func(config map[string]interface{}) (core.Tool, error) { return tools.NewCounterTool(), nil }) return td } func (td *ToolDiscovery) RegisterFactory(name string, factory ToolFactory) { td.mu.Lock() defer td.mu.Unlock() td.registry[name] = factory } func (td *ToolDiscovery) CreateTool(name string, config map[string]interface{}) (core.Tool, error) { td.mu.RLock() factory, exists := td.registry[name] td.mu.RUnlock() if !exists { return nil, fmt.Errorf(&#34;unknown tool type: %s&#34;, name) } return factory(config) } func (td *ToolDiscovery) ListAvailableTools() []string { td.mu.RLock() defer td.mu.RUnlock() tools := make([]string, 0, len(td.registry)) for name := range td.registry { tools = append(tools, name) } return tools }Production Integration Patterns 1. Tool Health Monitoring type ToolHealthMonitor struct { tools map[string]core.Tool metrics map[string]*ToolMetrics mu sync.RWMutex } type ToolMetrics struct { TotalCalls int64 `json:&#34;total_calls&#34;` SuccessCalls int64 `json:&#34;success_calls&#34;` ErrorCalls int64 `json:&#34;error_calls&#34;` AverageTime time.Duration `json:&#34;average_time&#34;` LastError string `json:&#34;last_error&#34;` LastErrorTime time.Time `json:&#34;last_error_time&#34;` } func NewToolHealthMonitor() *ToolHealthMonitor { return &amp;ToolHealthMonitor{ tools: make(map[string]core.Tool), metrics: make(map[string]*ToolMetrics), } } func (thm *ToolHealthMonitor) WrapTool(tool core.Tool) core.Tool { thm.mu.Lock() defer thm.mu.Unlock() name := tool.Name() thm.tools[name] = tool thm.metrics[name] = &amp;ToolMetrics{} return &amp;MonitoredTool{ tool: tool, monitor: thm, } } type MonitoredTool struct { tool core.Tool monitor *ToolHealthMonitor } func (mt *MonitoredTool) Name() string { return mt.tool.Name() } func (mt *MonitoredTool) Description() string { return mt.tool.Description() } func (mt *MonitoredTool) ParameterSchema() map[string]core.ParameterDefinition { return mt.tool.ParameterSchema() } func (mt *MonitoredTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) { start := time.Now() name := mt.tool.Name() // Execute tool result, err := mt.tool.Execute(ctx, params) // Record metrics duration := time.Since(start) mt.monitor.recordExecution(name, duration, err) return result, err } func (thm *ToolHealthMonitor) recordExecution(toolName string, duration time.Duration, err error) { thm.mu.Lock() defer thm.mu.Unlock() metrics := thm.metrics[toolName] metrics.TotalCalls&#43;&#43; if err != nil { metrics.ErrorCalls&#43;&#43; metrics.LastError = err.Error() metrics.LastErrorTime = time.Now() } else { metrics.SuccessCalls&#43;&#43; } // Update average time (simple moving average) if metrics.TotalCalls == 1 { metrics.AverageTime = duration } else { metrics.AverageTime = time.Duration( (int64(metrics.AverageTime)*metrics.TotalCalls &#43; int64(duration)) / (metrics.TotalCalls &#43; 1), ) } } func (thm *ToolHealthMonitor) GetMetrics(toolName string) (*ToolMetrics, error) { thm.mu.RLock() defer thm.mu.RUnlock() metrics, exists := thm.metrics[toolName] if !exists { return nil, fmt.Errorf(&#34;tool not found: %s&#34;, toolName) } // Return a copy to avoid race conditions return &amp;ToolMetrics{ TotalCalls: metrics.TotalCalls, SuccessCalls: metrics.SuccessCalls, ErrorCalls: metrics.ErrorCalls, AverageTime: metrics.AverageTime, LastError: metrics.LastError, LastErrorTime: metrics.LastErrorTime, }, nil } func (thm *ToolHealthMonitor) GetHealthStatus() map[string]string { thm.mu.RLock() defer thm.mu.RUnlock() status := make(map[string]string) for name, metrics := range thm.metrics { if metrics.TotalCalls == 0 { status[name] = &#34;unknown&#34; continue } errorRate := float64(metrics.ErrorCalls) / float64(metrics.TotalCalls) switch { case errorRate == 0: status[name] = &#34;healthy&#34; case errorRate &lt; 0.1: status[name] = &#34;warning&#34; default: status[name] = &#34;unhealthy&#34; } } return status }2. Complete Integration Example package main import ( &#34;context&#34; &#34;encoding/json&#34; &#34;fmt&#34; &#34;log&#34; &#34;os&#34; &#34;time&#34; &#34;github.com/kunalkushwaha/agenticgokit/core&#34; &#34;github.com/kunalkushwaha/agenticgokit/tools&#34; ) func main() { // Create tool discovery and manager discovery := NewToolDiscovery() manager := NewToolManager() monitor := NewToolHealthMonitor() // Configure tools toolConfigs := []struct { name string config ToolConfig params map[string]interface{} }{ { name: &#34;calculator&#34;, config: ToolConfig{ Name: &#34;calculator&#34;, Enabled: true, MaxCalls: 100, Timeout: 5 * time.Second, Cache: CacheConfig{ Enabled: true, TTL: 1 * time.Hour, }, }, }, { name: &#34;weather&#34;, config: ToolConfig{ Name: &#34;weather&#34;, Enabled: true, MaxCalls: 50, Timeout: 10 * time.Second, RateLimit: RateLimitConfig{ MaxRequests: 10, Interval: 1 * time.Minute, }, Cache: CacheConfig{ Enabled: true, TTL: 15 * time.Minute, }, }, params: map[string]interface{}{ &#34;api_key&#34;: os.Getenv(&#34;WEATHER_API_KEY&#34;), }, }, } // Create and register tools for _, tc := range toolConfigs { tool, err := discovery.CreateTool(tc.name, tc.params) if err != nil { log.Fatalf(&#34;Failed to create tool %s: %v&#34;, tc.name, err) } // Wrap with monitoring monitoredTool := monitor.WrapTool(tool) // Register with manager if err := manager.RegisterTool(monitoredTool, tc.config); err != nil { log.Fatalf(&#34;Failed to register tool %s: %v&#34;, tc.name, err) } } // Create MCP manager and register tools mcpManager := core.NewMCPManager() for _, toolName := range manager.ListEnabledTools() { tool, err := manager.GetTool(toolName) if err != nil { log.Printf(&#34;Failed to get tool %s: %v&#34;, toolName, err) continue } mcpManager.RegisterTool(toolName, tool) } // Create LLM provider llmProvider, err := core.NewOpenAIProvider( os.Getenv(&#34;OPENAI_API_KEY&#34;), &#34;gpt-4&#34;, core.WithTemperature(0.2), core.WithMaxTokens(1000), ) if err != nil { log.Fatalf(&#34;Failed to create LLM provider: %v&#34;, err) } // Create agent agent, err := core.NewAgent(&#34;assistant&#34;). WithLLM(llmProvider). WithMCP(mcpManager). WithMCPConfig(core.MCPConfig{ Tools: manager.ListEnabledTools(), MaxToolCalls: 5, ToolTimeout: 10 * time.Second, }). Build() if err != nil { log.Fatalf(&#34;Failed to create agent: %v&#34;, err) } // Create runner with tool monitoring runner := core.NewRunner(100) runner.RegisterAgent(&#34;assistant&#34;, agent) // Setup tool result handling setupToolResultHandling(runner) // Start runner ctx := context.Background() runner.Start(ctx) defer runner.Stop() // Example interaction event := core.NewEvent( &#34;assistant&#34;, core.EventData{&#34;message&#34;: &#34;Calculate 15 * 23 and tell me the weather in London&#34;}, map[string]string{&#34;session_id&#34;: &#34;demo-session&#34;}, ) runner.Emit(event) // Wait and show metrics time.Sleep(10 * time.Second) // Display tool health metrics fmt.Println(&#34;\nTool Health Status:&#34;) healthStatus := monitor.GetHealthStatus() for tool, status := range healthStatus { fmt.Printf(&#34;- %s: %s\n&#34;, tool, status) if metrics, err := monitor.GetMetrics(tool); err == nil { fmt.Printf(&#34; Calls: %d (Success: %d, Errors: %d)\n&#34;, metrics.TotalCalls, metrics.SuccessCalls, metrics.ErrorCalls) fmt.Printf(&#34; Average Time: %v\n&#34;, metrics.AverageTime) if metrics.LastError != &#34;&#34; { fmt.Printf(&#34; Last Error: %s (%v)\n&#34;, metrics.LastError, metrics.LastErrorTime) } } } }Best Practices 1. Tool Integration Guidelines Selective Tool Access: Only provide agents with tools they actually need Tool Validation: Always validate tool parameters and results Error Handling: Implement robust error handling and recovery Performance Monitoring: Monitor tool performance and health Security: Implement proper authentication and authorization Caching: Use caching for expensive or frequently called tools Rate Limiting: Protect external services with rate limiting 2. Prompting Best Practices Clear Tool Descriptions: Provide clear, concise tool descriptions Parameter Documentation: Document all parameters with examples Usage Examples: Include examples of when and how to use tools Error Guidance: Explain how to handle tool errors Tool Selection: Guide the agent on tool selection criteria 3. Production Considerations Monitoring: Implement comprehensive tool monitoring Logging: Log all tool executions for debugging Metrics: Track tool usage and performance metrics Health Checks: Implement tool health checking Fallbacks: Provide fallback mechanisms for tool failures Configuration: Make tool configuration externally manageable Troubleshooting Common Issues Tool Not Found: Ensure tools are properly registered with the MCP manager Parameter Validation Errors: Check parameter schemas and validation rules Timeout Errors: Adjust tool timeout settings for slow operations Rate Limit Exceeded: Configure appropriate rate limits for external services Authentication Failures: Verify API keys and authentication credentials Debugging Tips Enable detailed logging for tool executions Use tool health monitoring to identify problematic tools Test tools independently before integrating with agents Monitor tool performance metrics regularly Implement proper error handling and recovery mechanisms Conclusion Tool integration is a powerful feature that extends agent capabilities beyond text generation. By following the patterns and best practices in this tutorial, you can create robust, scalable tool integrations that enhance your agent systems.">
    <meta itemprop="datePublished" content="2025-07-25T00:00:00+00:00">
    <meta itemprop="dateModified" content="2025-07-25T00:00:00+00:00">
    <meta itemprop="wordCount" content="2749">
    <title>tool-integration :: AgenticGoKit Docs</title>
    <link href="/AgenticGoKitDocs/css/auto-complete/auto-complete.min.css?1753430931" rel="stylesheet">
    <script src="/AgenticGoKitDocs/js/auto-complete/auto-complete.min.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/search-lunr.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/search.js?1753430931" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/AgenticGoKitDocs/searchindex.en.js?1753430931";
    </script>
    <script src="/AgenticGoKitDocs/js/lunr/lunr.min.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/lunr/lunr.stemmer.support.min.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/lunr/lunr.multi.min.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/lunr/lunr.en.min.js?1753430931" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/AgenticGoKitDocs/fonts/fontawesome/css/fontawesome-all.min.css?1753430931" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/AgenticGoKitDocs/fonts/fontawesome/css/fontawesome-all.min.css?1753430931" rel="stylesheet"></noscript>
    <link href="/AgenticGoKitDocs/css/perfect-scrollbar/perfect-scrollbar.min.css?1753430931" rel="stylesheet">
    <link href="/AgenticGoKitDocs/css/theme.css?1753430931" rel="stylesheet">
    <link href="/AgenticGoKitDocs/css/format-html.css?1753430931" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/tutorials\/mcp\/tool-integration\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313\/AgenticGoKitDocs';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'blue' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="/AgenticGoKitDocs/tutorials/mcp/tool-integration/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#prerequisites">Prerequisites</a></li>
    <li><a href="#mcp-integration-architecture">MCP Integration Architecture</a></li>
    <li><a href="#basic-tool-integration">Basic Tool Integration</a>
      <ul>
        <li><a href="#1-setting-up-mcp-manager">1. Setting Up MCP Manager</a></li>
        <li><a href="#2-tool-aware-prompting">2. Tool-Aware Prompting</a></li>
        <li><a href="#3-handling-tool-results">3. Handling Tool Results</a></li>
      </ul>
    </li>
    <li><a href="#advanced-tool-integration">Advanced Tool Integration</a>
      <ul>
        <li><a href="#1-dynamic-tool-selection">1. Dynamic Tool Selection</a></li>
        <li><a href="#2-tool-result-processing">2. Tool Result Processing</a></li>
        <li><a href="#3-tool-caching-and-performance">3. Tool Caching and Performance</a></li>
      </ul>
    </li>
    <li><a href="#tool-configuration-and-management">Tool Configuration and Management</a>
      <ul>
        <li><a href="#1-tool-configuration">1. Tool Configuration</a></li>
        <li><a href="#2-tool-discovery-and-registration">2. Tool Discovery and Registration</a></li>
      </ul>
    </li>
    <li><a href="#production-integration-patterns">Production Integration Patterns</a>
      <ul>
        <li><a href="#1-tool-health-monitoring">1. Tool Health Monitoring</a></li>
        <li><a href="#2-complete-integration-example">2. Complete Integration Example</a></li>
      </ul>
    </li>
    <li><a href="#best-practices">Best Practices</a>
      <ul>
        <li><a href="#1-tool-integration-guidelines">1. Tool Integration Guidelines</a></li>
        <li><a href="#2-prompting-best-practices">2. Prompting Best Practices</a></li>
        <li><a href="#3-production-considerations">3. Production Considerations</a></li>
      </ul>
    </li>
    <li><a href="#troubleshooting">Troubleshooting</a>
      <ul>
        <li><a href="#common-issues">Common Issues</a></li>
        <li><a href="#debugging-tips">Debugging Tips</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#next-steps">Next Steps</a></li>
    <li><a href="#further-reading">Further Reading</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/AgenticGoKitDocs/index.html"><span itemprop="name">content</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/AgenticGoKitDocs/tutorials/index.html"><span itemprop="name">tutorials</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/AgenticGoKitDocs/tutorials/mcp/index.html"><span itemprop="name">mcp</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">tool-integration</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/AgenticGoKitDocs/tutorials/mcp/tool-development/index.html" title="tool-development (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/AgenticGoKitDocs/tutorials/memory-systems/index.html" title="memory-systems (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable tutorials" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="tool-integration">tool-integration</h1>

<h1 id="tool-integration-in-agenticgokit">Tool Integration in AgenticGoKit</h1>
<h2 id="overview">Overview</h2>
<p>Integrating tools with agents is a key capability in AgenticGoKit that enables agents to perform actions beyond text generation. This tutorial covers how to connect tools to agents, configure tool access, handle tool results, and implement tool-aware prompting.</p>
<p>Effective tool integration allows agents to interact with external systems, access specialized information, and perform complex tasks while maintaining a natural conversation flow.</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>Understanding of <a href="/AgenticGoKitDocs/tutorials/mcp/readme/index.html">MCP Overview</a></li>
<li>Familiarity with <a href="/AgenticGoKitDocs/tutorials/mcp/tool-development/index.html">Tool Development</a></li>
<li>Knowledge of <a href="/AgenticGoKitDocs/tutorials/core-concepts/agent-lifecycle/index.html">Agent Lifecycle</a></li>
<li>Basic understanding of <a href="/AgenticGoKitDocs/tutorials/core-concepts/state-management/index.html">State Management</a></li>
</ul>
<h2 id="mcp-integration-architecture">MCP Integration Architecture</h2>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>┌─────────────┐     ┌───────────────┐     ┌─────────────┐
│             │     │               │     │             │
│    Agent    │────▶│  MCP Manager  │────▶│    Tool     │
│             │     │               │     │             │
└─────────────┘     └───────────────┘     └─────────────┘
       ▲                     │                   │
       │                     ▼                   ▼
       │              ┌───────────────┐    ┌─────────────┐
       └──────────────│  Tool Result  │◀───│   External  │
                      │   Processor   │    │   Service   │
                      └───────────────┘    └─────────────┘</code></pre></div>
<h2 id="basic-tool-integration">Basic Tool Integration</h2>
<h3 id="1-setting-up-mcp-manager">1. Setting Up MCP Manager</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/core&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/tools&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create MCP manager</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewMCPManager</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#e6db74">&#34;calculator&#34;</span>, <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewCalculatorTool</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#e6db74">&#34;weather&#34;</span>, <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewWeatherTool</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;WEATHER_API_KEY&#34;</span>)))
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#e6db74">&#34;counter&#34;</span>, <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewCounterTool</span>())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create LLM provider</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llmProvider</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewOpenAIProvider</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;OPENAI_API_KEY&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;gpt-4&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">WithTemperature</span>(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">WithMaxTokens</span>(<span style="color:#ae81ff">1000</span>),
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create LLM provider: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create agent with MCP capability</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">agent</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewAgent</span>(<span style="color:#e6db74">&#34;assistant&#34;</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithLLM</span>(<span style="color:#a6e22e">llmProvider</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithMCP</span>(<span style="color:#a6e22e">mcpManager</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithMCPConfig</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">MCPConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Tools</span>:        []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;calculator&#34;</span>, <span style="color:#e6db74">&#34;weather&#34;</span>, <span style="color:#e6db74">&#34;counter&#34;</span>},
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">MaxToolCalls</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ToolTimeout</span>:  <span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>        }).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create agent: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create runner</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewRunner</span>(<span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">RegisterAgent</span>(<span style="color:#e6db74">&#34;assistant&#34;</span>, <span style="color:#a6e22e">agent</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Start runner</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">Start</span>(<span style="color:#a6e22e">ctx</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">Stop</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create event with user query</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">event</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewEvent</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;assistant&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">EventData</span>{<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;What&#39;s 25 * 16 and what&#39;s the weather in New York?&#34;</span>},
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;session_id&#34;</span>: <span style="color:#e6db74">&#34;test-session&#34;</span>},
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register callback to handle agent response</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">RegisterCallback</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">HookAfterAgentRun</span>, <span style="color:#e6db74">&#34;response-handler&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">args</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">CallbackArgs</span>) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">AgentResult</span>.<span style="color:#a6e22e">OutputState</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;response&#34;</span>); <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Agent response: %s\n&#34;</span>, <span style="color:#a6e22e">response</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Emit event</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">Emit</span>(<span style="color:#a6e22e">event</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Wait for response</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="2-tool-aware-prompting">2. Tool-Aware Prompting</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">createToolAwareAgent</span>() (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">AgentHandler</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create MCP manager</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewMCPManager</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#e6db74">&#34;calculator&#34;</span>, <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewCalculatorTool</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#e6db74">&#34;weather&#34;</span>, <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewWeatherTool</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;WEATHER_API_KEY&#34;</span>)))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create LLM provider</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llmProvider</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewOpenAIProvider</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;OPENAI_API_KEY&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;gpt-4&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">WithTemperature</span>(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">WithMaxTokens</span>(<span style="color:#ae81ff">1000</span>),
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;failed to create LLM provider: %w&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create tool-aware system prompt</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">systemPrompt</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">`You are a helpful assistant with access to the following tools:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1. calculator: Performs basic arithmetic operations (add, subtract, multiply, divide)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   - Parameters: operation (string), a (number), b (number)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2. weather: Gets current weather information for a specified location
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   - Parameters: location (string), units (string, optional)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">When you need to use a tool, use the following format:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;tool&gt;calculator&lt;/tool&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;parameters&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;operation&#34;: &#34;add&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;a&#34;: 5,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;b&#34;: 3
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;/parameters&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Wait for the tool result before continuing. Tool results will be provided in this format:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;tool_result&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;result&#34;: 8
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;/tool_result&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Answer user questions directly when you can, and use tools when necessary.`</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create agent with MCP capability and tool-aware prompt</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewAgent</span>(<span style="color:#e6db74">&#34;assistant&#34;</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithLLM</span>(<span style="color:#a6e22e">llmProvider</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithSystemPrompt</span>(<span style="color:#a6e22e">systemPrompt</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithMCP</span>(<span style="color:#a6e22e">mcpManager</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithMCPConfig</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">MCPConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Tools</span>:        []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;calculator&#34;</span>, <span style="color:#e6db74">&#34;weather&#34;</span>},
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">MaxToolCalls</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ToolTimeout</span>:  <span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>        }).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="3-handling-tool-results">3. Handling Tool Results</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">setupToolResultHandling</span>(<span style="color:#a6e22e">runner</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Runner</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register callback for tool execution</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">RegisterCallback</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">HookBeforeToolExecution</span>, <span style="color:#e6db74">&#34;tool-execution-logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">args</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">CallbackArgs</span>) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolName</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">ToolName</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolParams</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">ToolParams</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Executing tool: %s with params: %v\n&#34;</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">toolParams</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register callback for tool result</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">RegisterCallback</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">HookAfterToolExecution</span>, <span style="color:#e6db74">&#34;tool-result-logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">args</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">CallbackArgs</span>) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolName</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">ToolName</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolResult</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">ToolResult</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolError</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Error</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">toolError</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Tool %s failed: %v\n&#34;</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">toolError</span>)
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Tool %s result: %v\n&#34;</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">toolResult</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register callback for tool error</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">RegisterCallback</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">HookToolError</span>, <span style="color:#e6db74">&#34;tool-error-handler&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">args</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">CallbackArgs</span>) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">State</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolName</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">ToolName</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">toolError</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Error</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Tool error: %s - %v\n&#34;</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">toolError</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Add error information to state</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">newState</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">State</span>.<span style="color:#a6e22e">Clone</span>()
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">newState</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;tool_error&#34;</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;The %s tool encountered an error: %v&#34;</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">toolError</span>))
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">newState</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="advanced-tool-integration">Advanced Tool Integration</h2>
<h3 id="1-dynamic-tool-selection">1. Dynamic Tool Selection</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">DynamicToolSelector</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tools</span>       <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llmProvider</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">LLMProvider</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewDynamicToolSelector</span>(<span style="color:#a6e22e">llmProvider</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">LLMProvider</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">DynamicToolSelector</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">DynamicToolSelector</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tools</span>:       make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">llmProvider</span>: <span style="color:#a6e22e">llmProvider</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">dts</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">DynamicToolSelector</span>) <span style="color:#a6e22e">RegisterTool</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">tool</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dts</span>.<span style="color:#a6e22e">tools</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#a6e22e">tool</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">dts</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">DynamicToolSelector</span>) <span style="color:#a6e22e">SelectTools</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">query</span> <span style="color:#66d9ef">string</span>) ([]<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create tool descriptions</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">toolDescriptions</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Builder</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">tool</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">dts</span>.<span style="color:#a6e22e">tools</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">toolDescriptions</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;- %s: %s\n&#34;</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Description</span>()))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create prompt for tool selection</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">prompt</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">`Given the following user query and available tools, select the most appropriate tools to answer the query.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">User query: %s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Available tools:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">%s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Return only the names of the tools that should be used, separated by commas (e.g., &#34;calculator,weather&#34;).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">If no tools are needed, return &#34;none&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Selected tools:`</span>, <span style="color:#a6e22e">query</span>, <span style="color:#a6e22e">toolDescriptions</span>.<span style="color:#a6e22e">String</span>())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Get tool selection from LLM</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">dts</span>.<span style="color:#a6e22e">llmProvider</span>.<span style="color:#a6e22e">Generate</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">prompt</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;tool selection failed: %w&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Parse response</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response</span> = <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">TrimSpace</span>(<span style="color:#a6e22e">response</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;none&#34;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> []<span style="color:#66d9ef">string</span>{}, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Split by comma and trim spaces</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">selectedTools</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Split</span>(<span style="color:#a6e22e">response</span>, <span style="color:#e6db74">&#34;,&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">selectedTools</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">selectedTools</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">TrimSpace</span>(<span style="color:#a6e22e">selectedTools</span>[<span style="color:#a6e22e">i</span>])
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Validate selected tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">validTools</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">string</span>, <span style="color:#ae81ff">0</span>, len(<span style="color:#a6e22e">selectedTools</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">selectedTools</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">dts</span>.<span style="color:#a6e22e">tools</span>[<span style="color:#a6e22e">name</span>]; <span style="color:#a6e22e">exists</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">validTools</span> = append(<span style="color:#a6e22e">validTools</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">validTools</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="2-tool-result-processing">2. Tool Result Processing</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolResultProcessor</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llmProvider</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">LLMProvider</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewToolResultProcessor</span>(<span style="color:#a6e22e">llmProvider</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">LLMProvider</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolResultProcessor</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ToolResultProcessor</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">llmProvider</span>: <span style="color:#a6e22e">llmProvider</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">trp</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolResultProcessor</span>) <span style="color:#a6e22e">ProcessResult</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">toolName</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">result</span> <span style="color:#66d9ef">interface</span>{}, <span style="color:#a6e22e">query</span> <span style="color:#66d9ef">string</span>) (<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Convert result to string representation</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">resultStr</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%v&#34;</span>, <span style="color:#a6e22e">result</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">resultMap</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">result</span>.(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}); <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">resultBytes</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">MarshalIndent</span>(<span style="color:#a6e22e">resultMap</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;  &#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">resultStr</span> = string(<span style="color:#a6e22e">resultBytes</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create prompt for result processing</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">prompt</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">`You are processing the result of a tool execution. Format the result in a clear, human-readable way that answers the user&#39;s query.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">User query: %s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Tool used: %s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Tool result:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">%s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Provide a concise, helpful response based on this result:`</span>, <span style="color:#a6e22e">query</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">resultStr</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Get formatted response from LLM</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">trp</span>.<span style="color:#a6e22e">llmProvider</span>.<span style="color:#a6e22e">Generate</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">prompt</span>)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="3-tool-caching-and-performance">3. Tool Caching and Performance</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">CachedTool</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tool</span>      <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cache</span>     <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">CacheEntry</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cacheTTL</span>  <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mu</span>        <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">RWMutex</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">CacheEntry</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Result</span>    <span style="color:#66d9ef">interface</span>{}
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Timestamp</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewCachedTool</span>(<span style="color:#a6e22e">tool</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#a6e22e">cacheTTL</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">CachedTool</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tool</span>:     <span style="color:#a6e22e">tool</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cache</span>:    make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">CacheEntry</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cacheTTL</span>: <span style="color:#a6e22e">cacheTTL</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">Name</span>() <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Name</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">Description</span>() <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Description</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">ParameterSchema</span>() <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ParameterDefinition</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">ParameterSchema</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">Execute</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">params</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create cache key from parameters</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cacheKey</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">createCacheKey</span>(<span style="color:#a6e22e">params</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Check cache</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">found</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">getCachedResult</span>(<span style="color:#a6e22e">cacheKey</span>); <span style="color:#a6e22e">found</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Execute tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Execute</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">params</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Cache result</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">setCachedResult</span>(<span style="color:#a6e22e">cacheKey</span>, <span style="color:#a6e22e">result</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">createCacheKey</span>(<span style="color:#a6e22e">params</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create deterministic key from parameters</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">keys</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">string</span>, <span style="color:#ae81ff">0</span>, len(<span style="color:#a6e22e">params</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">k</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">params</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">keys</span> = append(<span style="color:#a6e22e">keys</span>, <span style="color:#a6e22e">k</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sort</span>.<span style="color:#a6e22e">Strings</span>(<span style="color:#a6e22e">keys</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">keyBuilder</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Builder</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">k</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">keys</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">keyBuilder</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%s:%v;&#34;</span>, <span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">params</span>[<span style="color:#a6e22e">k</span>]))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Hash the key for consistent length</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">hasher</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">sha256</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">hasher</span>.<span style="color:#a6e22e">Write</span>([]byte(<span style="color:#a6e22e">keyBuilder</span>.<span style="color:#a6e22e">String</span>()))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%x&#34;</span>, <span style="color:#a6e22e">hasher</span>.<span style="color:#a6e22e">Sum</span>(<span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">getCachedResult</span>(<span style="color:#a6e22e">key</span> <span style="color:#66d9ef">string</span>) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">entry</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cache</span>[<span style="color:#a6e22e">key</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Check if entry is expired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Timestamp</span>) &gt; <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cacheTTL</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Result</span>, <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">setCachedResult</span>(<span style="color:#a6e22e">key</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">result</span> <span style="color:#66d9ef">interface</span>{}) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cache</span>[<span style="color:#a6e22e">key</span>] = <span style="color:#a6e22e">CacheEntry</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Result</span>:    <span style="color:#a6e22e">result</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Timestamp</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>(),
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Clean up expired entries periodically</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cache</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">100</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">go</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cleanupExpiredEntries</span>()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">ct</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">CachedTool</span>) <span style="color:#a6e22e">cleanupExpiredEntries</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">now</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">entry</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cache</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">Sub</span>(<span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Timestamp</span>) &gt; <span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cacheTTL</span> {
</span></span><span style="display:flex;"><span>            delete(<span style="color:#a6e22e">ct</span>.<span style="color:#a6e22e">cache</span>, <span style="color:#a6e22e">key</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="tool-configuration-and-management">Tool Configuration and Management</h2>
<h3 id="1-tool-configuration">1. Tool Configuration</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolConfig</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Name</span>        <span style="color:#66d9ef">string</span>                 <span style="color:#e6db74">`json:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Enabled</span>     <span style="color:#66d9ef">bool</span>                   <span style="color:#e6db74">`json:&#34;enabled&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MaxCalls</span>    <span style="color:#66d9ef">int</span>                    <span style="color:#e6db74">`json:&#34;max_calls&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Timeout</span>     <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>          <span style="color:#e6db74">`json:&#34;timeout&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">RateLimit</span>   <span style="color:#a6e22e">RateLimitConfig</span>        <span style="color:#e6db74">`json:&#34;rate_limit&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Cache</span>       <span style="color:#a6e22e">CacheConfig</span>            <span style="color:#e6db74">`json:&#34;cache&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Parameters</span>  <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{} <span style="color:#e6db74">`json:&#34;parameters&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">RateLimitConfig</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MaxRequests</span> <span style="color:#66d9ef">int</span>           <span style="color:#e6db74">`json:&#34;max_requests&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Interval</span>    <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span> <span style="color:#e6db74">`json:&#34;interval&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">CacheConfig</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Enabled</span> <span style="color:#66d9ef">bool</span>          <span style="color:#e6db74">`json:&#34;enabled&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TTL</span>     <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span> <span style="color:#e6db74">`json:&#34;ttl&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolManager</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tools</span>   <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">configs</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">ToolConfig</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mu</span>      <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">RWMutex</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewToolManager</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolManager</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ToolManager</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tools</span>:   make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">configs</span>: make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">ToolConfig</span>),
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">tm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolManager</span>) <span style="color:#a6e22e">RegisterTool</span>(<span style="color:#a6e22e">tool</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#a6e22e">config</span> <span style="color:#a6e22e">ToolConfig</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Name</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Apply configuration wrappers</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">wrappedTool</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tool</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Add caching if enabled</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Cache</span>.<span style="color:#a6e22e">Enabled</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">wrappedTool</span> = <span style="color:#a6e22e">NewCachedTool</span>(<span style="color:#a6e22e">wrappedTool</span>, <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Cache</span>.<span style="color:#a6e22e">TTL</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Add rate limiting if configured</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">RateLimit</span>.<span style="color:#a6e22e">MaxRequests</span> &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">wrappedTool</span> = <span style="color:#a6e22e">NewRateLimitedTool</span>(<span style="color:#a6e22e">wrappedTool</span>, <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">RateLimit</span>.<span style="color:#a6e22e">MaxRequests</span>, <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">RateLimit</span>.<span style="color:#a6e22e">Interval</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Add validation</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">wrappedTool</span> = <span style="color:#a6e22e">NewValidatedTool</span>(<span style="color:#a6e22e">wrappedTool</span>, <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">tools</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#a6e22e">wrappedTool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">configs</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#a6e22e">config</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">tm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolManager</span>) <span style="color:#a6e22e">GetTool</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tool</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">tools</span>[<span style="color:#a6e22e">name</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;tool not found: %s&#34;</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">config</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">configs</span>[<span style="color:#a6e22e">name</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Enabled</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;tool disabled: %s&#34;</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tool</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">tm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolManager</span>) <span style="color:#a6e22e">ListEnabledTools</span>() []<span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">enabled</span> []<span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">config</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">tm</span>.<span style="color:#a6e22e">configs</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Enabled</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">enabled</span> = append(<span style="color:#a6e22e">enabled</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">enabled</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="2-tool-discovery-and-registration">2. Tool Discovery and Registration</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolDiscovery</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">registry</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">ToolFactory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mu</span>       <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">RWMutex</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolFactory</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">config</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewToolDiscovery</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolDiscovery</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ToolDiscovery</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">registry</span>: make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">ToolFactory</span>),
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register built-in tool factories</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">RegisterFactory</span>(<span style="color:#e6db74">&#34;calculator&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">config</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewCalculatorTool</span>(), <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">RegisterFactory</span>(<span style="color:#e6db74">&#34;weather&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">config</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">apiKey</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">config</span>[<span style="color:#e6db74">&#34;api_key&#34;</span>].(<span style="color:#66d9ef">string</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">ok</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;weather tool requires api_key parameter&#34;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewWeatherTool</span>(<span style="color:#a6e22e">apiKey</span>), <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">RegisterFactory</span>(<span style="color:#e6db74">&#34;counter&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">config</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">NewCounterTool</span>(), <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">td</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">td</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolDiscovery</span>) <span style="color:#a6e22e">RegisterFactory</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">factory</span> <span style="color:#a6e22e">ToolFactory</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">registry</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#a6e22e">factory</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">td</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolDiscovery</span>) <span style="color:#a6e22e">CreateTool</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">config</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">factory</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">registry</span>[<span style="color:#a6e22e">name</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;unknown tool type: %s&#34;</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">factory</span>(<span style="color:#a6e22e">config</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">td</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolDiscovery</span>) <span style="color:#a6e22e">ListAvailableTools</span>() []<span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tools</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">string</span>, <span style="color:#ae81ff">0</span>, len(<span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">registry</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">td</span>.<span style="color:#a6e22e">registry</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tools</span> = append(<span style="color:#a6e22e">tools</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tools</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="production-integration-patterns">Production Integration Patterns</h2>
<h3 id="1-tool-health-monitoring">1. Tool Health Monitoring</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolHealthMonitor</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tools</span>   <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">metrics</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#f92672">*</span><span style="color:#a6e22e">ToolMetrics</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mu</span>      <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">RWMutex</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ToolMetrics</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TotalCalls</span>    <span style="color:#66d9ef">int64</span>         <span style="color:#e6db74">`json:&#34;total_calls&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">SuccessCalls</span>  <span style="color:#66d9ef">int64</span>         <span style="color:#e6db74">`json:&#34;success_calls&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ErrorCalls</span>    <span style="color:#66d9ef">int64</span>         <span style="color:#e6db74">`json:&#34;error_calls&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">AverageTime</span>   <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span> <span style="color:#e6db74">`json:&#34;average_time&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">LastError</span>     <span style="color:#66d9ef">string</span>        <span style="color:#e6db74">`json:&#34;last_error&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">LastErrorTime</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>     <span style="color:#e6db74">`json:&#34;last_error_time&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewToolHealthMonitor</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolHealthMonitor</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ToolHealthMonitor</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tools</span>:   make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>: make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#f92672">*</span><span style="color:#a6e22e">ToolMetrics</span>),
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">thm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolHealthMonitor</span>) <span style="color:#a6e22e">WrapTool</span>(<span style="color:#a6e22e">tool</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>) <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Name</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">tools</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#a6e22e">tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">metrics</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ToolMetrics</span>{}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">MonitoredTool</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tool</span>:    <span style="color:#a6e22e">tool</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">monitor</span>: <span style="color:#a6e22e">thm</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">MonitoredTool</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tool</span>    <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">monitor</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolHealthMonitor</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">mt</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MonitoredTool</span>) <span style="color:#a6e22e">Name</span>() <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">mt</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Name</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">mt</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MonitoredTool</span>) <span style="color:#a6e22e">Description</span>() <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">mt</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Description</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">mt</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MonitoredTool</span>) <span style="color:#a6e22e">ParameterSchema</span>() <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ParameterDefinition</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">mt</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">ParameterSchema</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">mt</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MonitoredTool</span>) <span style="color:#a6e22e">Execute</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">params</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">start</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">mt</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Name</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Execute tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">mt</span>.<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">Execute</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">params</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Record metrics</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">duration</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">start</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mt</span>.<span style="color:#a6e22e">monitor</span>.<span style="color:#a6e22e">recordExecution</span>(<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">duration</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">thm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolHealthMonitor</span>) <span style="color:#a6e22e">recordExecution</span>(<span style="color:#a6e22e">toolName</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">duration</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">metrics</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">metrics</span>[<span style="color:#a6e22e">toolName</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">ErrorCalls</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastError</span> = <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>()
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastErrorTime</span> = <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">SuccessCalls</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Update average time (simple moving average)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">AverageTime</span> = <span style="color:#a6e22e">duration</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">AverageTime</span> = <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>(
</span></span><span style="display:flex;"><span>            (int64(<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">AverageTime</span>)<span style="color:#f92672">*</span><span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span> <span style="color:#f92672">+</span> int64(<span style="color:#a6e22e">duration</span>)) <span style="color:#f92672">/</span> (<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">thm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolHealthMonitor</span>) <span style="color:#a6e22e">GetMetrics</span>(<span style="color:#a6e22e">toolName</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">ToolMetrics</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">metrics</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">metrics</span>[<span style="color:#a6e22e">toolName</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;tool not found: %s&#34;</span>, <span style="color:#a6e22e">toolName</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Return a copy to avoid race conditions</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ToolMetrics</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">TotalCalls</span>:    <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">SuccessCalls</span>:  <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">SuccessCalls</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ErrorCalls</span>:    <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">ErrorCalls</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">AverageTime</span>:   <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">AverageTime</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">LastError</span>:     <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastError</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">LastErrorTime</span>: <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastErrorTime</span>,
</span></span><span style="display:flex;"><span>    }, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">thm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ToolHealthMonitor</span>) <span style="color:#a6e22e">GetHealthStatus</span>() <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">mu</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">status</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">metrics</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">thm</span>.<span style="color:#a6e22e">metrics</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">status</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#e6db74">&#34;unknown&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">errorRate</span> <span style="color:#f92672">:=</span> float64(<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">ErrorCalls</span>) <span style="color:#f92672">/</span> float64(<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">errorRate</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">status</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#e6db74">&#34;healthy&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">errorRate</span> &lt; <span style="color:#ae81ff">0.1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">status</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#e6db74">&#34;warning&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">status</span>[<span style="color:#a6e22e">name</span>] = <span style="color:#e6db74">&#34;unhealthy&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">status</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="2-complete-integration-example">2. Complete Integration Example</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/core&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/tools&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create tool discovery and manager</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">discovery</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewToolDiscovery</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">manager</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewToolManager</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">monitor</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewToolHealthMonitor</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Configure tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">toolConfigs</span> <span style="color:#f92672">:=</span> []<span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">name</span>   <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">config</span> <span style="color:#a6e22e">ToolConfig</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">params</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}
</span></span><span style="display:flex;"><span>    }{
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span>: <span style="color:#e6db74">&#34;calculator&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">config</span>: <span style="color:#a6e22e">ToolConfig</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Name</span>:     <span style="color:#e6db74">&#34;calculator&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Enabled</span>:  <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">MaxCalls</span>: <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Timeout</span>:  <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Cache</span>: <span style="color:#a6e22e">CacheConfig</span>{
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Enabled</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">TTL</span>:     <span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Hour</span>,
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span>: <span style="color:#e6db74">&#34;weather&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">config</span>: <span style="color:#a6e22e">ToolConfig</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Name</span>:     <span style="color:#e6db74">&#34;weather&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Enabled</span>:  <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">MaxCalls</span>: <span style="color:#ae81ff">50</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Timeout</span>:  <span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">RateLimit</span>: <span style="color:#a6e22e">RateLimitConfig</span>{
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">MaxRequests</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Interval</span>:    <span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Minute</span>,
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Cache</span>: <span style="color:#a6e22e">CacheConfig</span>{
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Enabled</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">TTL</span>:     <span style="color:#ae81ff">15</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Minute</span>,
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">params</span>: <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;api_key&#34;</span>: <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;WEATHER_API_KEY&#34;</span>),
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create and register tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">tc</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">toolConfigs</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tool</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">discovery</span>.<span style="color:#a6e22e">CreateTool</span>(<span style="color:#a6e22e">tc</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">tc</span>.<span style="color:#a6e22e">params</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create tool %s: %v&#34;</span>, <span style="color:#a6e22e">tc</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Wrap with monitoring</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">monitoredTool</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">monitor</span>.<span style="color:#a6e22e">WrapTool</span>(<span style="color:#a6e22e">tool</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Register with manager</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">manager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#a6e22e">monitoredTool</span>, <span style="color:#a6e22e">tc</span>.<span style="color:#a6e22e">config</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to register tool %s: %v&#34;</span>, <span style="color:#a6e22e">tc</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create MCP manager and register tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mcpManager</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewMCPManager</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">toolName</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">manager</span>.<span style="color:#a6e22e">ListEnabledTools</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tool</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">manager</span>.<span style="color:#a6e22e">GetTool</span>(<span style="color:#a6e22e">toolName</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Failed to get tool %s: %v&#34;</span>, <span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mcpManager</span>.<span style="color:#a6e22e">RegisterTool</span>(<span style="color:#a6e22e">toolName</span>, <span style="color:#a6e22e">tool</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create LLM provider</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llmProvider</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewOpenAIProvider</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;OPENAI_API_KEY&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;gpt-4&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">WithTemperature</span>(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">WithMaxTokens</span>(<span style="color:#ae81ff">1000</span>),
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create LLM provider: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create agent</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">agent</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewAgent</span>(<span style="color:#e6db74">&#34;assistant&#34;</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithLLM</span>(<span style="color:#a6e22e">llmProvider</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithMCP</span>(<span style="color:#a6e22e">mcpManager</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithMCPConfig</span>(<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">MCPConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Tools</span>:        <span style="color:#a6e22e">manager</span>.<span style="color:#a6e22e">ListEnabledTools</span>(),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">MaxToolCalls</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ToolTimeout</span>:  <span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>        }).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create agent: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create runner with tool monitoring</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewRunner</span>(<span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">RegisterAgent</span>(<span style="color:#e6db74">&#34;assistant&#34;</span>, <span style="color:#a6e22e">agent</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Setup tool result handling</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setupToolResultHandling</span>(<span style="color:#a6e22e">runner</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Start runner</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">Start</span>(<span style="color:#a6e22e">ctx</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">Stop</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Example interaction</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">event</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">NewEvent</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;assistant&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">EventData</span>{<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Calculate 15 * 23 and tell me the weather in London&#34;</span>},
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;session_id&#34;</span>: <span style="color:#e6db74">&#34;demo-session&#34;</span>},
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runner</span>.<span style="color:#a6e22e">Emit</span>(<span style="color:#a6e22e">event</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Wait and show metrics</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Display tool health metrics</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;\nTool Health Status:&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">healthStatus</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">monitor</span>.<span style="color:#a6e22e">GetHealthStatus</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">tool</span>, <span style="color:#a6e22e">status</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">healthStatus</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;- %s: %s\n&#34;</span>, <span style="color:#a6e22e">tool</span>, <span style="color:#a6e22e">status</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">metrics</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">monitor</span>.<span style="color:#a6e22e">GetMetrics</span>(<span style="color:#a6e22e">tool</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;  Calls: %d (Success: %d, Errors: %d)\n&#34;</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalCalls</span>, <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">SuccessCalls</span>, <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">ErrorCalls</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;  Average Time: %v\n&#34;</span>, <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">AverageTime</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastError</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;  Last Error: %s (%v)\n&#34;</span>, <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastError</span>, <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">LastErrorTime</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-tool-integration-guidelines">1. Tool Integration Guidelines</h3>
<ul>
<li><strong>Selective Tool Access</strong>: Only provide agents with tools they actually need</li>
<li><strong>Tool Validation</strong>: Always validate tool parameters and results</li>
<li><strong>Error Handling</strong>: Implement robust error handling and recovery</li>
<li><strong>Performance Monitoring</strong>: Monitor tool performance and health</li>
<li><strong>Security</strong>: Implement proper authentication and authorization</li>
<li><strong>Caching</strong>: Use caching for expensive or frequently called tools</li>
<li><strong>Rate Limiting</strong>: Protect external services with rate limiting</li>
</ul>
<h3 id="2-prompting-best-practices">2. Prompting Best Practices</h3>
<ul>
<li><strong>Clear Tool Descriptions</strong>: Provide clear, concise tool descriptions</li>
<li><strong>Parameter Documentation</strong>: Document all parameters with examples</li>
<li><strong>Usage Examples</strong>: Include examples of when and how to use tools</li>
<li><strong>Error Guidance</strong>: Explain how to handle tool errors</li>
<li><strong>Tool Selection</strong>: Guide the agent on tool selection criteria</li>
</ul>
<h3 id="3-production-considerations">3. Production Considerations</h3>
<ul>
<li><strong>Monitoring</strong>: Implement comprehensive tool monitoring</li>
<li><strong>Logging</strong>: Log all tool executions for debugging</li>
<li><strong>Metrics</strong>: Track tool usage and performance metrics</li>
<li><strong>Health Checks</strong>: Implement tool health checking</li>
<li><strong>Fallbacks</strong>: Provide fallback mechanisms for tool failures</li>
<li><strong>Configuration</strong>: Make tool configuration externally manageable</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<ol>
<li><strong>Tool Not Found</strong>: Ensure tools are properly registered with the MCP manager</li>
<li><strong>Parameter Validation Errors</strong>: Check parameter schemas and validation rules</li>
<li><strong>Timeout Errors</strong>: Adjust tool timeout settings for slow operations</li>
<li><strong>Rate Limit Exceeded</strong>: Configure appropriate rate limits for external services</li>
<li><strong>Authentication Failures</strong>: Verify API keys and authentication credentials</li>
</ol>
<h3 id="debugging-tips">Debugging Tips</h3>
<ul>
<li>Enable detailed logging for tool executions</li>
<li>Use tool health monitoring to identify problematic tools</li>
<li>Test tools independently before integrating with agents</li>
<li>Monitor tool performance metrics regularly</li>
<li>Implement proper error handling and recovery mechanisms</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Tool integration is a powerful feature that extends agent capabilities beyond text generation. By following the patterns and best practices in this tutorial, you can create robust, scalable tool integrations that enhance your agent systems.</p>
<p>Key takeaways:</p>
<ul>
<li>Use the MCP manager to register and manage tools</li>
<li>Implement proper tool configuration and monitoring</li>
<li>Handle tool results and errors gracefully</li>
<li>Follow security and performance best practices</li>
<li>Monitor tool health and performance in production</li>
</ul>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li><a href="/AgenticGoKitDocs/tutorials/mcp/advanced-tool-patterns/index.html">Advanced Tool Patterns</a> - Explore complex tool usage patterns</li>
<li><a href="/AgenticGoKitDocs/tutorials/mcp/tool-development/index.html">Tool Development</a> - Learn how to create custom tools</li>
<li><a href="/AgenticGoKitDocs/tutorials/core-concepts/state-management/index.html">State Management</a> - Understand state flow with tools</li>
</ul>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="/AgenticGoKitDocs/reference/api/agent/index.html#mcp">API Reference: MCP</a></li>
<li><a href="../../examples/">Examples: Tool Usage</a></li>
<li><a href="/AgenticGoKitDocs/guides/deployment/readme/index.html">Production Deployment</a></li>
</ul>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Jul 25, 2025
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
          <a id="R-logo" class="R-default" href="/AgenticGoKitDocs/index.html">
            <div class="logo-title">AgenticGoKit Docs</div>
          </a>
        </div>
        <search><form action="/AgenticGoKitDocs/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/index.html"><a class="padding" href="/AgenticGoKitDocs/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/readme/index.html">content</a></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/guides/index.html"><input type="checkbox" id="R-section-8fc2fd7736125e87cab8840a86c2af5a" aria-controls="R-subsections-8fc2fd7736125e87cab8840a86c2af5a" checked><label for="R-section-8fc2fd7736125e87cab8840a86c2af5a"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu guides</span></label><a class="padding" href="/AgenticGoKitDocs/guides/index.html">guides</a><ul id="R-subsections-8fc2fd7736125e87cab8840a86c2af5a" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/readme/index.html">guides</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/agentbasics/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/agentbasics/index.html">AgentBasics</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/examples/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/examples/index.html">Examples</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/configuration/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/configuration/index.html">Configuration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/customtools/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/customtools/index.html">CustomTools</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/providers/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/providers/index.html">Providers</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/memoryprovidersetup/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/memoryprovidersetup/index.html">MemoryProviderSetup</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/memorytroubleshooting/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/memorytroubleshooting/index.html">MemoryTroubleshooting</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/embeddingmodelguide/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/embeddingmodelguide/index.html">EmbeddingModelGuide</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/ragconfiguration/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/ragconfiguration/index.html">RAGConfiguration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/toolintegration/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/toolintegration/index.html">ToolIntegration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/pgvectorsetup/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/pgvectorsetup/index.html">PgVectorSetup</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/weaviatesetup/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/weaviatesetup/index.html">WeaviateSetup</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/performance/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/performance/index.html">Performance</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/errorhandling/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/errorhandling/index.html">ErrorHandling</a></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/guides/deployment/index.html"><input type="checkbox" id="R-section-ecc839349395ef3c015a12132049dff2" aria-controls="R-subsections-ecc839349395ef3c015a12132049dff2" checked><label for="R-section-ecc839349395ef3c015a12132049dff2"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu deployment</span></label><a class="padding" href="/AgenticGoKitDocs/guides/deployment/index.html">deployment</a><ul id="R-subsections-ecc839349395ef3c015a12132049dff2" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/deployment/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/deployment/readme/index.html">deployment</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/guides/development/index.html"><input type="checkbox" id="R-section-fff1f5eca5d0a93209b9c6262762c25a" aria-controls="R-subsections-fff1f5eca5d0a93209b9c6262762c25a" checked><label for="R-section-fff1f5eca5d0a93209b9c6262762c25a"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu development</span></label><a class="padding" href="/AgenticGoKitDocs/guides/development/index.html">development</a><ul id="R-subsections-fff1f5eca5d0a93209b9c6262762c25a" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/readme/index.html">development</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/best-practices/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/best-practices/index.html">best-practices</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/debugging/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/debugging/index.html">debugging</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/research-assistant/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/research-assistant/index.html">research-assistant</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/testing-agents/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/testing-agents/index.html">testing-agents</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/visualization/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/visualization/index.html">visualization</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/development/web-search-integration/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/development/web-search-integration/index.html">web-search-integration</a></li></ul></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/framework-comparison/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/framework-comparison/index.html">framework-comparison</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/memory/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/memory/index.html">Memory</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/scaffoldmemoryguide/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/scaffoldmemoryguide/index.html">ScaffoldMemoryGuide</a></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/guides/setup/index.html"><input type="checkbox" id="R-section-0124aed9abb5064d53391168f3c95c22" aria-controls="R-subsections-0124aed9abb5064d53391168f3c95c22" checked><label for="R-section-0124aed9abb5064d53391168f3c95c22"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu setup</span></label><a class="padding" href="/AgenticGoKitDocs/guides/setup/index.html">setup</a><ul id="R-subsections-0124aed9abb5064d53391168f3c95c22" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/setup/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/setup/readme/index.html">setup</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/setup/llm-providers/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/setup/llm-providers/index.html">llm-providers</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/setup/mcp-tools/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/setup/mcp-tools/index.html">mcp-tools</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/setup/orchestration-configuration/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/setup/orchestration-configuration/index.html">orchestration-configuration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/setup/vector-databases/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/setup/vector-databases/index.html">vector-databases</a></li></ul></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/guides/troubleshooting/index.html"><a class="padding" href="/AgenticGoKitDocs/guides/troubleshooting/index.html">troubleshooting</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/contributors/index.html"><input type="checkbox" id="R-section-190d9b328fbda7e13ab386f7a5417de5" aria-controls="R-subsections-190d9b328fbda7e13ab386f7a5417de5" checked><label for="R-section-190d9b328fbda7e13ab386f7a5417de5"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu contributors</span></label><a class="padding" href="/AgenticGoKitDocs/contributors/index.html">contributors</a><ul id="R-subsections-190d9b328fbda7e13ab386f7a5417de5" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/readme/index.html">contributors</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/contributorguide/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/contributorguide/index.html">ContributorGuide</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/codestyle/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/codestyle/index.html">CodeStyle</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/corevsinternal/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/corevsinternal/index.html">CoreVsInternal</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/addingfeatures/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/addingfeatures/index.html">AddingFeatures</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/testing/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/testing/index.html">Testing</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/contributors/docsstandards/index.html"><a class="padding" href="/AgenticGoKitDocs/contributors/docsstandards/index.html">DocsStandards</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/reference/index.html"><input type="checkbox" id="R-section-66002f201bef818664bb81aa67490c58" aria-controls="R-subsections-66002f201bef818664bb81aa67490c58" checked><label for="R-section-66002f201bef818664bb81aa67490c58"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu reference</span></label><a class="padding" href="/AgenticGoKitDocs/reference/index.html">reference</a><ul id="R-subsections-66002f201bef818664bb81aa67490c58" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/readme/index.html">reference</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/api/configuration/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/api/configuration/index.html">configuration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/cli/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/cli/index.html">cli</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/api/mcp/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/api/mcp/index.html">mcp</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/api/agent/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/api/agent/index.html">agent</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/api/memory/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/api/memory/index.html">memory</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/api/orchestration/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/api/orchestration/index.html">orchestration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/reference/api/state-event/index.html"><a class="padding" href="/AgenticGoKitDocs/reference/api/state-event/index.html">state-event</a></li></ul></li>
            <li class="parent alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/index.html"><input type="checkbox" id="R-section-e1e8c1e70c5500b49e8dda2dc550651a" aria-controls="R-subsections-e1e8c1e70c5500b49e8dda2dc550651a" checked><label for="R-section-e1e8c1e70c5500b49e8dda2dc550651a"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu tutorials</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/index.html">tutorials</a><ul id="R-subsections-e1e8c1e70c5500b49e8dda2dc550651a" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/readme/index.html">tutorials</a></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/advanced/index.html"><input type="checkbox" id="R-section-d3def5cd76adc8096d0ff9fda6b8e479" aria-controls="R-subsections-d3def5cd76adc8096d0ff9fda6b8e479" checked><label for="R-section-d3def5cd76adc8096d0ff9fda6b8e479"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu advanced</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/advanced/index.html">advanced</a><ul id="R-subsections-d3def5cd76adc8096d0ff9fda6b8e479" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/advanced/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/advanced/readme/index.html">advanced</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/advanced/circuit-breaker-patterns/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/advanced/circuit-breaker-patterns/index.html">circuit-breaker-patterns</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/advanced/load-balancing-scaling/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/advanced/load-balancing-scaling/index.html">load-balancing-scaling</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/advanced/retry-policies/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/advanced/retry-policies/index.html">retry-policies</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/advanced/testing-strategies/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/advanced/testing-strategies/index.html">testing-strategies</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/index.html"><input type="checkbox" id="R-section-212c6ccffb40ecdd78eb2136f98c4cac" aria-controls="R-subsections-212c6ccffb40ecdd78eb2136f98c4cac" checked><label for="R-section-212c6ccffb40ecdd78eb2136f98c4cac"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu core-concepts</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/index.html">core-concepts</a><ul id="R-subsections-212c6ccffb40ecdd78eb2136f98c4cac" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/readme/index.html">core-concepts</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/agent-lifecycle/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/agent-lifecycle/index.html">agent-lifecycle</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/error-handling/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/error-handling/index.html">error-handling</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/message-passing/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/message-passing/index.html">message-passing</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/orchestration-patterns/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/orchestration-patterns/index.html">orchestration-patterns</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/core-concepts/state-management/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/core-concepts/state-management/index.html">state-management</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/debugging/index.html"><input type="checkbox" id="R-section-d8dfe6eec6c6d4cb6f6f50bdd07fa3cc" aria-controls="R-subsections-d8dfe6eec6c6d4cb6f6f50bdd07fa3cc" checked><label for="R-section-d8dfe6eec6c6d4cb6f6f50bdd07fa3cc"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu debugging</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/debugging/index.html">debugging</a><ul id="R-subsections-d8dfe6eec6c6d4cb6f6f50bdd07fa3cc" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/debugging/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/debugging/readme/index.html">debugging</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/debugging/debugging-multi-agent-systems/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/debugging/debugging-multi-agent-systems/index.html">debugging-multi-agent-systems</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/debugging/logging-and-tracing/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/debugging/logging-and-tracing/index.html">logging-and-tracing</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/index.html"><input type="checkbox" id="R-section-e7f904c8b9d0f9bf1f07ca7d482d2247" aria-controls="R-subsections-e7f904c8b9d0f9bf1f07ca7d482d2247" checked><label for="R-section-e7f904c8b9d0f9bf1f07ca7d482d2247"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu getting-started</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/index.html">getting-started</a><ul id="R-subsections-e7f904c8b9d0f9bf1f07ca7d482d2247" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/readme/index.html">getting-started</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/memory-and-rag/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/memory-and-rag/index.html">memory-and-rag</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/multi-agent-collaboration/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/multi-agent-collaboration/index.html">multi-agent-collaboration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/production-deployment/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/production-deployment/index.html">production-deployment</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/quickstart/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/quickstart/index.html">quickstart</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/tool-integration/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/tool-integration/index.html">tool-integration</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/getting-started/your-first-agent/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/getting-started/your-first-agent/index.html">your-first-agent</a></li></ul></li>
            <li class="parent alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/mcp/index.html"><input type="checkbox" id="R-section-153aac44598009a99dd5a60317a3eecc" aria-controls="R-subsections-153aac44598009a99dd5a60317a3eecc" checked><label for="R-section-153aac44598009a99dd5a60317a3eecc"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu mcp</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/mcp/index.html">mcp</a><ul id="R-subsections-153aac44598009a99dd5a60317a3eecc" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/mcp/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/mcp/readme/index.html">mcp</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/mcp/advanced-tool-patterns/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/mcp/advanced-tool-patterns/index.html">advanced-tool-patterns</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/mcp/tool-development/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/mcp/tool-development/index.html">tool-development</a></li>
            <li class="active " data-nav-id="/AgenticGoKitDocs/tutorials/mcp/tool-integration/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/mcp/tool-integration/index.html">tool-integration</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/index.html"><input type="checkbox" id="R-section-9c1a65f2d7b3888241dcafa51a0710e7" aria-controls="R-subsections-9c1a65f2d7b3888241dcafa51a0710e7" checked><label for="R-section-9c1a65f2d7b3888241dcafa51a0710e7"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu memory-systems</span></label><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/index.html">memory-systems</a><ul id="R-subsections-9c1a65f2d7b3888241dcafa51a0710e7" class="collapsible-menu">
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/readme/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/readme/index.html">memory-systems</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/basic-memory/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/basic-memory/index.html">basic-memory</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/document-ingestion/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/document-ingestion/index.html">document-ingestion</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/knowledge-bases/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/knowledge-bases/index.html">knowledge-bases</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/memory-optimization/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/memory-optimization/index.html">memory-optimization</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/rag-implementation/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/rag-implementation/index.html">rag-implementation</a></li>
            <li class="" data-nav-id="/AgenticGoKitDocs/tutorials/memory-systems/vector-databases/index.html"><a class="padding" href="/AgenticGoKitDocs/tutorials/memory-systems/vector-databases/index.html">vector-databases</a></li></ul></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/AgenticGoKitDocs/js/clipboard/clipboard.min.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/perfect-scrollbar/perfect-scrollbar.min.js?1753430931" defer></script>
    <script src="/AgenticGoKitDocs/js/theme.js?1753430931" defer></script>
  </body>
</html>
